"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["8857"],{3162(e,s,n){n.r(s),n.d(s,{metadata:()=>r,default:()=>h,frontMatter:()=>a,contentTitle:()=>i,toc:()=>d,assets:()=>l});var r=JSON.parse('{"id":"api/act/src/classes/Act","title":"Act","description":"@rotorsoft/act-root","source":"@site/docs/api/act/src/classes/Act.md","sourceDirName":"api/act/src/classes","slug":"/api/act/src/classes/Act","permalink":"/act-root/docs/api/act/src/classes/Act","draft":false,"unlisted":false,"editUrl":"https://github.com/rotorsoft/act-root/edit/master/docs/docs/api/act/src/classes/Act.md","tags":[],"version":"current","frontMatter":{}}'),c=n(6259),t=n(3230);let a={},i,l={},d=[{value:"See",id:"see",level:2},{value:"Usage",id:"usage",level:2},{value:"Type Parameters",id:"type-parameters",level:2},{value:"S",id:"s",level:3},{value:"E",id:"e",level:3},{value:"A",id:"a",level:3},{value:"M",id:"m",level:3},{value:"Constructors",id:"constructors",level:2},{value:"Constructor",id:"constructor",level:3},{value:"Parameters",id:"parameters",level:4},{value:"registry",id:"registry",level:5},{value:"_states?",id:"_states",level:5},{value:"Returns",id:"returns",level:4},{value:"Properties",id:"properties",level:2},{value:"registry",id:"registry-1",level:3},{value:"Methods",id:"methods",level:2},{value:"correlate()",id:"correlate",level:3},{value:"Parameters",id:"parameters-1",level:4},{value:"query?",id:"query",level:5},{value:"Returns",id:"returns-1",level:4},{value:"Examples",id:"examples",level:4},{value:"See",id:"see-1",level:4},{value:"do()",id:"do",level:3},{value:"Type Parameters",id:"type-parameters-1",level:4},{value:"K",id:"k",level:5},{value:"Parameters",id:"parameters-2",level:4},{value:"action",id:"action",level:5},{value:"target",id:"target",level:5},{value:"payload",id:"payload",level:5},{value:"reactingTo?",id:"reactingto",level:5},{value:"skipValidation?",id:"skipvalidation",level:5},{value:"Returns",id:"returns-2",level:4},{value:"Throws",id:"throws",level:4},{value:"Throws",id:"throws-1",level:4},{value:"Throws",id:"throws-2",level:4},{value:"Examples",id:"examples-1",level:4},{value:"See",id:"see-2",level:4},{value:"drain()",id:"drain",level:3},{value:"Parameters",id:"parameters-3",level:4},{value:"options?",id:"options",level:5},{value:"Returns",id:"returns-3",level:4},{value:"Examples",id:"examples-2",level:4},{value:"See",id:"see-3",level:4},{value:"emit()",id:"emit",level:3},{value:"Call Signature",id:"call-signature",level:4},{value:"Parameters",id:"parameters-4",level:5},{value:"event",id:"event",level:6},{value:"args",id:"args",level:6},{value:"Returns",id:"returns-4",level:5},{value:"Call Signature",id:"call-signature-1",level:4},{value:"Parameters",id:"parameters-5",level:5},{value:"event",id:"event-1",level:6},{value:"args",id:"args-1",level:6},{value:"Returns",id:"returns-5",level:5},{value:"Call Signature",id:"call-signature-2",level:4},{value:"Parameters",id:"parameters-6",level:5},{value:"event",id:"event-2",level:6},{value:"args",id:"args-2",level:6},{value:"Returns",id:"returns-6",level:5},{value:"load()",id:"load",level:3},{value:"Call Signature",id:"call-signature-3",level:4},{value:"Type Parameters",id:"type-parameters-2",level:5},{value:"SX",id:"sx",level:6},{value:"EX",id:"ex",level:6},{value:"AX",id:"ax",level:6},{value:"Parameters",id:"parameters-7",level:5},{value:"state",id:"state",level:6},{value:"stream",id:"stream",level:6},{value:"callback?",id:"callback",level:6},{value:"Returns",id:"returns-7",level:5},{value:"Examples",id:"examples-3",level:5},{value:"See",id:"see-4",level:5},{value:"Call Signature",id:"call-signature-4",level:4},{value:"Type Parameters",id:"type-parameters-3",level:5},{value:"K",id:"k-1",level:6},{value:"Parameters",id:"parameters-8",level:5},{value:"name",id:"name",level:6},{value:"stream",id:"stream-1",level:6},{value:"callback?",id:"callback-1",level:6},{value:"Returns",id:"returns-8",level:5},{value:"Examples",id:"examples-4",level:5},{value:"See",id:"see-5",level:5},{value:"off()",id:"off",level:3},{value:"Call Signature",id:"call-signature-5",level:4},{value:"Parameters",id:"parameters-9",level:5},{value:"event",id:"event-3",level:6},{value:"listener",id:"listener",level:6},{value:"Returns",id:"returns-9",level:5},{value:"Call Signature",id:"call-signature-6",level:4},{value:"Parameters",id:"parameters-10",level:5},{value:"event",id:"event-4",level:6},{value:"listener",id:"listener-1",level:6},{value:"Returns",id:"returns-10",level:5},{value:"Call Signature",id:"call-signature-7",level:4},{value:"Parameters",id:"parameters-11",level:5},{value:"event",id:"event-5",level:6},{value:"listener",id:"listener-2",level:6},{value:"Returns",id:"returns-11",level:5},{value:"on()",id:"on",level:3},{value:"Call Signature",id:"call-signature-8",level:4},{value:"Parameters",id:"parameters-12",level:5},{value:"event",id:"event-6",level:6},{value:"listener",id:"listener-3",level:6},{value:"Returns",id:"returns-12",level:5},{value:"Call Signature",id:"call-signature-9",level:4},{value:"Parameters",id:"parameters-13",level:5},{value:"event",id:"event-7",level:6},{value:"listener",id:"listener-4",level:6},{value:"Returns",id:"returns-13",level:5},{value:"Call Signature",id:"call-signature-10",level:4},{value:"Parameters",id:"parameters-14",level:5},{value:"event",id:"event-8",level:6},{value:"listener",id:"listener-5",level:6},{value:"Returns",id:"returns-14",level:5},{value:"query()",id:"query-1",level:3},{value:"Parameters",id:"parameters-15",level:4},{value:"query",id:"query-2",level:5},{value:"callback?",id:"callback-2",level:5},{value:"Returns",id:"returns-15",level:4},{value:"Examples",id:"examples-5",level:4},{value:"See",id:"see-6",level:4},{value:"query_array()",id:"query_array",level:3},{value:"Parameters",id:"parameters-16",level:4},{value:"query",id:"query-3",level:5},{value:"Returns",id:"returns-16",level:4},{value:"Examples",id:"examples-6",level:4},{value:"See",id:"see-7",level:4},{value:"start_correlations()",id:"start_correlations",level:3},{value:"Parameters",id:"parameters-17",level:4},{value:"query?",id:"query-4",level:5},{value:"frequency?",id:"frequency",level:5},{value:"callback?",id:"callback-3",level:5},{value:"Returns",id:"returns-17",level:4},{value:"Examples",id:"examples-7",level:4},{value:"See",id:"see-8",level:4},{value:"stop_correlations()",id:"stop_correlations",level:3},{value:"Returns",id:"returns-18",level:4},{value:"Example",id:"example",level:4},{value:"See",id:"see-9",level:4}];function o(e){let s={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.p,{children:(0,c.jsx)(s.a,{href:"/act-root/docs/api/",children:(0,c.jsx)(s.strong,{children:"@rotorsoft/act-root"})})}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/",children:"@rotorsoft/act-root"})," / ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/",children:"act/src"})," / Act"]}),"\n",(0,c.jsx)(s.h1,{id:"class-acts-e-a-m",children:"Class: Act<S, E, A, M>"}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L48",children:"libs/act/src/act.ts:48"})]}),"\n",(0,c.jsx)(s.h2,{id:"see",children:"See"}),"\n",(0,c.jsx)(s.p,{children:"Store"}),"\n",(0,c.jsx)(s.p,{children:"Main orchestrator for event-sourced state machines and workflows."}),"\n",(0,c.jsx)(s.p,{children:"It manages the lifecycle of actions, reactions, and event streams, providing APIs for loading state, executing actions, querying events, and draining reactions."}),"\n",(0,c.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const app = new Act(registry, 100);\nawait app.do("increment", { stream: "counter1", actor }, { by: 1 });\nconst snapshot = await app.load(Counter, "counter1");\nawait app.drain();\n'})}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:["Register event listeners with ",(0,c.jsx)(s.code,{children:'.on("committed", ...)'})," and ",(0,c.jsx)(s.code,{children:'.on("acked", ...)'})," to react to lifecycle events."]}),"\n",(0,c.jsxs)(s.li,{children:["Use ",(0,c.jsx)(s.code,{children:".query()"})," to analyze event streams for analytics or debugging."]}),"\n"]}),"\n",(0,c.jsx)(s.h2,{id:"type-parameters",children:"Type Parameters"}),"\n",(0,c.jsx)(s.h3,{id:"s",children:"S"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"S"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/SchemaRegister",children:(0,c.jsx)(s.code,{children:"SchemaRegister"})}),"<",(0,c.jsx)(s.code,{children:"A"}),">"]}),"\n",(0,c.jsx)(s.p,{children:"SchemaRegister for state"}),"\n",(0,c.jsx)(s.h3,{id:"e",children:"E"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"E"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,c.jsx)(s.code,{children:"Schemas"})})]}),"\n",(0,c.jsx)(s.p,{children:"Schemas for events"}),"\n",(0,c.jsx)(s.h3,{id:"a",children:"A"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"A"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,c.jsx)(s.code,{children:"Schemas"})})]}),"\n",(0,c.jsx)(s.p,{children:"Schemas for actions"}),"\n",(0,c.jsx)(s.h3,{id:"m",children:"M"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"M"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.code,{children:"Record"}),"<",(0,c.jsx)(s.code,{children:"string"}),", ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schema",children:(0,c.jsx)(s.code,{children:"Schema"})}),"> = ",(0,c.jsx)(s.code,{children:"Record"}),"<",(0,c.jsx)(s.code,{children:"string"}),", ",(0,c.jsx)(s.code,{children:"never"}),">"]}),"\n",(0,c.jsx)(s.h2,{id:"constructors",children:"Constructors"}),"\n",(0,c.jsx)(s.h3,{id:"constructor",children:"Constructor"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"new Act"}),"<",(0,c.jsx)(s.code,{children:"S"}),", ",(0,c.jsx)(s.code,{children:"E"}),", ",(0,c.jsx)(s.code,{children:"A"}),", ",(0,c.jsx)(s.code,{children:"M"}),">(",(0,c.jsx)(s.code,{children:"registry"}),", ",(0,c.jsx)(s.code,{children:"_states?"}),"): ",(0,c.jsx)(s.code,{children:"Act"}),"<",(0,c.jsx)(s.code,{children:"S"}),", ",(0,c.jsx)(s.code,{children:"E"}),", ",(0,c.jsx)(s.code,{children:"A"}),", ",(0,c.jsx)(s.code,{children:"M"}),">"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L115",children:"libs/act/src/act.ts:115"})]}),"\n",(0,c.jsx)(s.p,{children:"Create a new Act orchestrator."}),"\n",(0,c.jsx)(s.h4,{id:"parameters",children:"Parameters"}),"\n",(0,c.jsx)(s.h5,{id:"registry",children:"registry"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Registry",children:(0,c.jsx)(s.code,{children:"Registry"})}),"<",(0,c.jsx)(s.code,{children:"S"}),", ",(0,c.jsx)(s.code,{children:"E"}),", ",(0,c.jsx)(s.code,{children:"A"}),">"]}),"\n",(0,c.jsx)(s.p,{children:"The registry of state, event, and action schemas"}),"\n",(0,c.jsx)(s.h5,{id:"_states",children:"_states?"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Map"}),"<",(0,c.jsx)(s.code,{children:"string"}),", ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/State",children:(0,c.jsx)(s.code,{children:"State"})}),"<",(0,c.jsx)(s.code,{children:"any"}),", ",(0,c.jsx)(s.code,{children:"any"}),", ",(0,c.jsx)(s.code,{children:"any"}),">> = ",(0,c.jsx)(s.code,{children:"..."})]}),"\n",(0,c.jsx)(s.h4,{id:"returns",children:"Returns"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Act"}),"<",(0,c.jsx)(s.code,{children:"S"}),", ",(0,c.jsx)(s.code,{children:"E"}),", ",(0,c.jsx)(s.code,{children:"A"}),", ",(0,c.jsx)(s.code,{children:"M"}),">"]}),"\n",(0,c.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,c.jsx)(s.h3,{id:"registry-1",children:"registry"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"readonly"})," ",(0,c.jsx)(s.strong,{children:"registry"}),": ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Registry",children:(0,c.jsx)(s.code,{children:"Registry"})}),"<",(0,c.jsx)(s.code,{children:"S"}),", ",(0,c.jsx)(s.code,{children:"E"}),", ",(0,c.jsx)(s.code,{children:"A"}),">"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L116",children:"libs/act/src/act.ts:116"})]}),"\n",(0,c.jsx)(s.p,{children:"The registry of state, event, and action schemas"}),"\n",(0,c.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,c.jsx)(s.h3,{id:"correlate",children:"correlate()"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"correlate"}),"(",(0,c.jsx)(s.code,{children:"query?"}),"): ",(0,c.jsx)(s.code,{children:"Promise"}),"<{ ",(0,c.jsx)(s.code,{children:"last_id"}),": ",(0,c.jsx)(s.code,{children:"number"}),"; ",(0,c.jsx)(s.code,{children:"leased"}),": ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Lease",children:(0,c.jsx)(s.code,{children:"Lease"})}),"[]; }>"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L679",children:"libs/act/src/act.ts:679"})]}),"\n",(0,c.jsx)(s.p,{children:"Discovers and registers new streams dynamically based on reaction resolvers."}),"\n",(0,c.jsx)(s.p,{children:'Correlation enables "dynamic reactions" where target streams are determined at runtime\nbased on event content. For example, you might create a stats stream for each user\nwhen they perform certain actions.'}),"\n",(0,c.jsx)(s.p,{children:"This method scans events matching the query and identifies new target streams based\non reaction resolvers. It then registers these streams so they'll be picked up by\nthe next drain cycle."}),"\n",(0,c.jsx)(s.h4,{id:"parameters-1",children:"Parameters"}),"\n",(0,c.jsx)(s.h5,{id:"query",children:"query?"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Query",children:(0,c.jsx)(s.code,{children:"Query"})})," = ",(0,c.jsx)(s.code,{children:"..."})]}),"\n",(0,c.jsx)(s.p,{children:"Query filter to scan for new correlations"}),"\n",(0,c.jsx)(s.h4,{id:"returns-1",children:"Returns"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Promise"}),"<{ ",(0,c.jsx)(s.code,{children:"last_id"}),": ",(0,c.jsx)(s.code,{children:"number"}),"; ",(0,c.jsx)(s.code,{children:"leased"}),": ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Lease",children:(0,c.jsx)(s.code,{children:"Lease"})}),"[]; }>"]}),"\n",(0,c.jsx)(s.p,{children:"Object with newly leased streams and last scanned event ID"}),"\n",(0,c.jsx)(s.h4,{id:"examples",children:"Examples"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:"// Scan for new streams\nconst { leased, last_id } = await app.correlate({ after: 0, limit: 100 });\nconsole.log(`Found ${leased.length} new streams`);\n\n// Save last_id for next scan\nawait saveCheckpoint(last_id);\n"})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const app = act()\n  .with(User)\n  .with(UserStats)\n  .on("UserLoggedIn")\n    .do(async (event) => ["incrementLoginCount", {}])\n    .to((event) => ({\n      target: `stats-${event.stream}` // Dynamic target per user\n    }))\n  .build();\n\n// Discover stats streams as users log in\nawait app.correlate();\n'})}),"\n",(0,c.jsx)(s.h4,{id:"see-1",children:"See"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"#start_correlations",children:"start_correlations"})," for automatic periodic correlation"]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"#stop_correlations",children:"stop_correlations"})," to stop automatic correlation"]}),"\n"]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"do",children:"do()"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"do"}),"<",(0,c.jsx)(s.code,{children:"K"}),">(",(0,c.jsx)(s.code,{children:"action"}),", ",(0,c.jsx)(s.code,{children:"target"}),", ",(0,c.jsx)(s.code,{children:"payload"}),", ",(0,c.jsx)(s.code,{children:"reactingTo?"}),", ",(0,c.jsx)(s.code,{children:"skipValidation?"}),"): ",(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:(0,c.jsx)(s.code,{children:"Snapshot"})}),"<",(0,c.jsx)(s.code,{children:"S"}),"[",(0,c.jsx)(s.code,{children:"K"}),"], ",(0,c.jsx)(s.code,{children:"E"}),">[]>"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L209",children:"libs/act/src/act.ts:209"})]}),"\n",(0,c.jsx)(s.p,{children:"Executes an action on a state instance, committing resulting events."}),"\n",(0,c.jsx)(s.p,{children:"This is the primary method for modifying state. It:"}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsx)(s.li,{children:"Validates the action payload against the schema"}),"\n",(0,c.jsx)(s.li,{children:"Loads the current state snapshot"}),"\n",(0,c.jsx)(s.li,{children:"Checks invariants (business rules)"}),"\n",(0,c.jsx)(s.li,{children:"Executes the action handler to generate events"}),"\n",(0,c.jsx)(s.li,{children:"Applies events to create new state"}),"\n",(0,c.jsx)(s.li,{children:"Commits events to the store with optimistic concurrency control"}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"type-parameters-1",children:"Type Parameters"}),"\n",(0,c.jsx)(s.h5,{id:"k",children:"K"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"K"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.code,{children:"string"})," | ",(0,c.jsx)(s.code,{children:"number"})," | ",(0,c.jsx)(s.code,{children:"symbol"})]}),"\n",(0,c.jsx)(s.p,{children:"Action name from registered actions"}),"\n",(0,c.jsx)(s.h4,{id:"parameters-2",children:"Parameters"}),"\n",(0,c.jsx)(s.h5,{id:"action",children:"action"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"K"})}),"\n",(0,c.jsx)(s.p,{children:"The name of the action to execute"}),"\n",(0,c.jsx)(s.h5,{id:"target",children:"target"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Target",children:(0,c.jsx)(s.code,{children:"Target"})})}),"\n",(0,c.jsx)(s.p,{children:"Target specification with stream ID and actor context"}),"\n",(0,c.jsx)(s.h5,{id:"payload",children:"payload"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Readonly"}),"<",(0,c.jsx)(s.code,{children:"A"}),"[",(0,c.jsx)(s.code,{children:"K"}),"]>"]}),"\n",(0,c.jsx)(s.p,{children:"Action payload matching the action's schema"}),"\n",(0,c.jsx)(s.h5,{id:"reactingto",children:"reactingTo?"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Committed",children:(0,c.jsx)(s.code,{children:"Committed"})}),"<",(0,c.jsx)(s.code,{children:"E"}),", ",(0,c.jsx)(s.code,{children:"string"})," & keyof ",(0,c.jsx)(s.code,{children:"E"}),">"]}),"\n",(0,c.jsx)(s.p,{children:"Optional event that triggered this action (for correlation)"}),"\n",(0,c.jsx)(s.h5,{id:"skipvalidation",children:"skipValidation?"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"boolean"})," = ",(0,c.jsx)(s.code,{children:"false"})]}),"\n",(0,c.jsx)(s.p,{children:"Skip schema validation (use carefully, for performance)"}),"\n",(0,c.jsx)(s.h4,{id:"returns-2",children:"Returns"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:(0,c.jsx)(s.code,{children:"Snapshot"})}),"<",(0,c.jsx)(s.code,{children:"S"}),"[",(0,c.jsx)(s.code,{children:"K"}),"], ",(0,c.jsx)(s.code,{children:"E"}),">[]>"]}),"\n",(0,c.jsx)(s.p,{children:"Array of snapshots for all affected states (usually one)"}),"\n",(0,c.jsx)(s.h4,{id:"throws",children:"Throws"}),"\n",(0,c.jsx)(s.p,{children:"If payload doesn't match action schema"}),"\n",(0,c.jsx)(s.h4,{id:"throws-1",children:"Throws"}),"\n",(0,c.jsx)(s.p,{children:"If business rules are violated"}),"\n",(0,c.jsx)(s.h4,{id:"throws-2",children:"Throws"}),"\n",(0,c.jsx)(s.p,{children:"If another process modified the stream"}),"\n",(0,c.jsx)(s.h4,{id:"examples-1",children:"Examples"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const snapshots = await app.do(\n  "increment",\n  {\n    stream: "counter-1",\n    actor: { id: "user1", name: "Alice" }\n  },\n  { by: 5 }\n);\n\nconsole.log(snapshots[0].state.count); // Current count after increment\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'try {\n  await app.do(\n    "withdraw",\n    { stream: "account-123", actor: { id: "user1", name: "Alice" } },\n    { amount: 1000 }\n  );\n} catch (error) {\n  if (error instanceof InvariantError) {\n    console.error("Business rule violated:", error.description);\n  } else if (error instanceof ConcurrencyError) {\n    console.error("Concurrent modification detected, retry...");\n  } else if (error instanceof ValidationError) {\n    console.error("Invalid payload:", error.details);\n  }\n}\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const app = act()\n  .with(Order)\n  .with(Inventory)\n  .on("OrderPlaced")\n    .do(async (event, context) => {\n      // This action is triggered by an event\n      const result = await context.app.do(\n        "reduceStock",\n        {\n          stream: "inventory-1",\n          actor: event.meta.causation.action.actor\n        },\n        { amount: event.data.items.length },\n        event // Pass event for correlation tracking\n      );\n      return result;\n    })\n    .to("inventory-1")\n  .build();\n'})}),"\n",(0,c.jsx)(s.h4,{id:"see-2",children:"See"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Target",children:"Target"})," for target structure"]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:"Snapshot"})," for return value structure"]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/classes/ValidationError",children:"ValidationError"}),", ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/classes/InvariantError",children:"InvariantError"}),", ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/classes/ConcurrencyError",children:"ConcurrencyError"})]}),"\n"]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"drain",children:"drain()"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"drain"}),"(",(0,c.jsx)(s.code,{children:"options?"}),"): ",(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Drain",children:(0,c.jsx)(s.code,{children:"Drain"})}),"<",(0,c.jsx)(s.code,{children:"E"}),">>"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L515",children:"libs/act/src/act.ts:515"})]}),"\n",(0,c.jsx)(s.p,{children:"Processes pending reactions by draining uncommitted events from the event store."}),"\n",(0,c.jsx)(s.p,{children:"The drain process:"}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsx)(s.li,{children:"Polls the store for streams with uncommitted events"}),"\n",(0,c.jsx)(s.li,{children:"Leases streams to prevent concurrent processing"}),"\n",(0,c.jsx)(s.li,{children:"Fetches events for each leased stream"}),"\n",(0,c.jsx)(s.li,{children:"Executes matching reaction handlers"}),"\n",(0,c.jsx)(s.li,{children:"Acknowledges successful reactions or blocks failing ones"}),"\n"]}),"\n",(0,c.jsx)(s.p,{children:"Drain uses a dual-frontier strategy to balance processing of new streams (lagging)\nvs active streams (leading). The ratio adapts based on event pressure."}),"\n",(0,c.jsx)(s.p,{children:"Call this method periodically in a background loop, or after committing events."}),"\n",(0,c.jsx)(s.h4,{id:"parameters-3",children:"Parameters"}),"\n",(0,c.jsx)(s.h5,{id:"options",children:"options?"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/DrainOptions",children:(0,c.jsx)(s.code,{children:"DrainOptions"})})," = ",(0,c.jsx)(s.code,{children:"{}"})]}),"\n",(0,c.jsx)(s.p,{children:"Drain configuration options"}),"\n",(0,c.jsx)(s.h4,{id:"returns-3",children:"Returns"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Drain",children:(0,c.jsx)(s.code,{children:"Drain"})}),"<",(0,c.jsx)(s.code,{children:"E"}),">>"]}),"\n",(0,c.jsx)(s.p,{children:"Drain statistics with fetched, leased, acked, and blocked counts"}),"\n",(0,c.jsx)(s.h4,{id:"examples-2",children:"Examples"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'// Process reactions after each action\nawait app.do("createUser", target, payload);\nawait app.drain();\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'setInterval(async () => {\n  try {\n    const result = await app.drain({\n      streamLimit: 20,\n      eventLimit: 50\n    });\n    if (result.acked.length) {\n      console.log(`Processed ${result.acked.length} streams`);\n    }\n  } catch (error) {\n    console.error("Drain error:", error);\n  }\n}, 5000); // Every 5 seconds\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'app.on("acked", (leases) => {\n  console.log(`Acknowledged ${leases.length} streams`);\n});\n\napp.on("blocked", (blocked) => {\n  console.error(`Blocked ${blocked.length} streams due to errors`);\n  blocked.forEach(({ stream, error }) => {\n    console.error(`Stream ${stream}: ${error}`);\n  });\n});\n\nawait app.drain();\n'})}),"\n",(0,c.jsx)(s.h4,{id:"see-3",children:"See"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"#correlate",children:"correlate"})," for dynamic stream discovery"]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"#start_correlations",children:"start_correlations"})," for automatic correlation"]}),"\n"]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"emit",children:"emit()"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"emit"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"args"}),"): ",(0,c.jsx)(s.code,{children:"boolean"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L66",children:"libs/act/src/act.ts:66"})]}),"\n",(0,c.jsx)(s.p,{children:"Emit a lifecycle event (internal use, but can be used for custom listeners)."}),"\n",(0,c.jsx)(s.h5,{id:"parameters-4",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"committed"'})}),"\n",(0,c.jsx)(s.p,{children:'The event name ("committed", "acked",  or "blocked")'}),"\n",(0,c.jsx)(s.h6,{id:"args",children:"args"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:(0,c.jsx)(s.code,{children:"Snapshot"})}),"<",(0,c.jsx)(s.code,{children:"S"}),", ",(0,c.jsx)(s.code,{children:"E"}),">[]"]}),"\n",(0,c.jsx)(s.p,{children:"The event payload"}),"\n",(0,c.jsx)(s.h5,{id:"returns-4",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"boolean"})}),"\n",(0,c.jsx)(s.p,{children:"true if the event had listeners, false otherwise"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-1",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"emit"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"args"}),"): ",(0,c.jsx)(s.code,{children:"boolean"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L67",children:"libs/act/src/act.ts:67"})]}),"\n",(0,c.jsx)(s.p,{children:"Emit a lifecycle event (internal use, but can be used for custom listeners)."}),"\n",(0,c.jsx)(s.h5,{id:"parameters-5",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event-1",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"acked"'})}),"\n",(0,c.jsx)(s.p,{children:'The event name ("committed", "acked",  or "blocked")'}),"\n",(0,c.jsx)(s.h6,{id:"args-1",children:"args"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Lease",children:(0,c.jsx)(s.code,{children:"Lease"})}),"[]"]}),"\n",(0,c.jsx)(s.p,{children:"The event payload"}),"\n",(0,c.jsx)(s.h5,{id:"returns-5",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"boolean"})}),"\n",(0,c.jsx)(s.p,{children:"true if the event had listeners, false otherwise"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-2",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"emit"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"args"}),"): ",(0,c.jsx)(s.code,{children:"boolean"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L68",children:"libs/act/src/act.ts:68"})]}),"\n",(0,c.jsx)(s.p,{children:"Emit a lifecycle event (internal use, but can be used for custom listeners)."}),"\n",(0,c.jsx)(s.h5,{id:"parameters-6",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event-2",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"blocked"'})}),"\n",(0,c.jsx)(s.p,{children:'The event name ("committed", "acked",  or "blocked")'}),"\n",(0,c.jsx)(s.h6,{id:"args-2",children:"args"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Lease",children:(0,c.jsx)(s.code,{children:"Lease"})})," & ",(0,c.jsx)(s.code,{children:"object"}),"[]"]}),"\n",(0,c.jsx)(s.p,{children:"The event payload"}),"\n",(0,c.jsx)(s.h5,{id:"returns-6",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"boolean"})}),"\n",(0,c.jsx)(s.p,{children:"true if the event had listeners, false otherwise"}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"load",children:"load()"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-3",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"load"}),"<",(0,c.jsx)(s.code,{children:"SX"}),", ",(0,c.jsx)(s.code,{children:"EX"}),", ",(0,c.jsx)(s.code,{children:"AX"}),">(",(0,c.jsx)(s.code,{children:"state"}),", ",(0,c.jsx)(s.code,{children:"stream"}),", ",(0,c.jsx)(s.code,{children:"callback?"}),"): ",(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:(0,c.jsx)(s.code,{children:"Snapshot"})}),"<",(0,c.jsx)(s.code,{children:"SX"}),", ",(0,c.jsx)(s.code,{children:"EX"}),">>"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L269",children:"libs/act/src/act.ts:269"})]}),"\n",(0,c.jsx)(s.p,{children:"Loads the current state snapshot for a specific stream."}),"\n",(0,c.jsx)(s.p,{children:"Reconstructs the current state by replaying events from the event store.\nUses snapshots when available to optimize loading performance."}),"\n",(0,c.jsxs)(s.p,{children:["Accepts either a State definition object or a state name string. When\nusing a string, the merged state (from partial states registered via\n",(0,c.jsx)(s.code,{children:".with()"}),") is resolved by name."]}),"\n",(0,c.jsx)(s.h5,{id:"type-parameters-2",children:"Type Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"sx",children:"SX"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"SX"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schema",children:(0,c.jsx)(s.code,{children:"Schema"})})]}),"\n",(0,c.jsx)(s.p,{children:"State schema type"}),"\n",(0,c.jsx)(s.h6,{id:"ex",children:"EX"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"EX"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,c.jsx)(s.code,{children:"Schemas"})})]}),"\n",(0,c.jsx)(s.p,{children:"Event schemas type"}),"\n",(0,c.jsx)(s.h6,{id:"ax",children:"AX"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"AX"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,c.jsx)(s.code,{children:"Schemas"})})]}),"\n",(0,c.jsx)(s.p,{children:"Action schemas type"}),"\n",(0,c.jsx)(s.h5,{id:"parameters-7",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"state",children:"state"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/State",children:(0,c.jsx)(s.code,{children:"State"})}),"<",(0,c.jsx)(s.code,{children:"SX"}),", ",(0,c.jsx)(s.code,{children:"EX"}),", ",(0,c.jsx)(s.code,{children:"AX"}),">"]}),"\n",(0,c.jsx)(s.p,{children:"The state definition or state name to load"}),"\n",(0,c.jsx)(s.h6,{id:"stream",children:"stream"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"string"})}),"\n",(0,c.jsx)(s.p,{children:"The stream ID (state instance identifier)"}),"\n",(0,c.jsx)(s.h6,{id:"callback",children:"callback?"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"snapshot"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"Optional callback invoked with the loaded snapshot"}),"\n",(0,c.jsx)(s.h5,{id:"returns-7",children:"Returns"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:(0,c.jsx)(s.code,{children:"Snapshot"})}),"<",(0,c.jsx)(s.code,{children:"SX"}),", ",(0,c.jsx)(s.code,{children:"EX"}),">>"]}),"\n",(0,c.jsx)(s.p,{children:"The current state snapshot for the stream"}),"\n",(0,c.jsx)(s.h5,{id:"examples-3",children:"Examples"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const snapshot = await app.load(Counter, "counter-1");\nconsole.log(snapshot.state.count);    // Current count\nconsole.log(snapshot.patches);        // Events since last snapshot\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const snapshot = await app.load("Ticket", "ticket-123");\nconsole.log(snapshot.state.title);    // Merged state from all partials\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const [user, account] = await Promise.all([\n  app.load(User, "user-123"),\n  app.load(BankAccount, "account-456")\n]);\n'})}),"\n",(0,c.jsx)(s.h5,{id:"see-4",children:"See"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:"Snapshot"})," for snapshot structure"]}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-4",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"load"}),"<",(0,c.jsx)(s.code,{children:"K"}),">(",(0,c.jsx)(s.code,{children:"name"}),", ",(0,c.jsx)(s.code,{children:"stream"}),", ",(0,c.jsx)(s.code,{children:"callback?"}),"): ",(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:(0,c.jsx)(s.code,{children:"Snapshot"})}),"<",(0,c.jsx)(s.code,{children:"M"}),"[",(0,c.jsx)(s.code,{children:"K"}),"], ",(0,c.jsx)(s.code,{children:"E"}),">>"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L274",children:"libs/act/src/act.ts:274"})]}),"\n",(0,c.jsx)(s.p,{children:"Loads the current state snapshot for a specific stream."}),"\n",(0,c.jsx)(s.p,{children:"Reconstructs the current state by replaying events from the event store.\nUses snapshots when available to optimize loading performance."}),"\n",(0,c.jsxs)(s.p,{children:["Accepts either a State definition object or a state name string. When\nusing a string, the merged state (from partial states registered via\n",(0,c.jsx)(s.code,{children:".with()"}),") is resolved by name."]}),"\n",(0,c.jsx)(s.h5,{id:"type-parameters-3",children:"Type Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"k-1",children:"K"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"K"})," ",(0,c.jsx)(s.em,{children:"extends"})," ",(0,c.jsx)(s.code,{children:"string"})]}),"\n",(0,c.jsx)(s.h5,{id:"parameters-8",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"name",children:"name"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"K"})}),"\n",(0,c.jsx)(s.h6,{id:"stream-1",children:"stream"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"string"})}),"\n",(0,c.jsx)(s.p,{children:"The stream ID (state instance identifier)"}),"\n",(0,c.jsx)(s.h6,{id:"callback-1",children:"callback?"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"snapshot"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"Optional callback invoked with the loaded snapshot"}),"\n",(0,c.jsx)(s.h5,{id:"returns-8",children:"Returns"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:(0,c.jsx)(s.code,{children:"Snapshot"})}),"<",(0,c.jsx)(s.code,{children:"M"}),"[",(0,c.jsx)(s.code,{children:"K"}),"], ",(0,c.jsx)(s.code,{children:"E"}),">>"]}),"\n",(0,c.jsx)(s.p,{children:"The current state snapshot for the stream"}),"\n",(0,c.jsx)(s.h5,{id:"examples-4",children:"Examples"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const snapshot = await app.load(Counter, "counter-1");\nconsole.log(snapshot.state.count);    // Current count\nconsole.log(snapshot.patches);        // Events since last snapshot\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const snapshot = await app.load("Ticket", "ticket-123");\nconsole.log(snapshot.state.title);    // Merged state from all partials\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const [user, account] = await Promise.all([\n  app.load(User, "user-123"),\n  app.load(BankAccount, "account-456")\n]);\n'})}),"\n",(0,c.jsx)(s.h5,{id:"see-5",children:"See"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Snapshot",children:"Snapshot"})," for snapshot structure"]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"off",children:"off()"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-5",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"off"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"listener"}),"): ",(0,c.jsx)(s.code,{children:"this"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L98",children:"libs/act/src/act.ts:98"})]}),"\n",(0,c.jsx)(s.p,{children:"Remove a listener for a lifecycle event."}),"\n",(0,c.jsx)(s.h5,{id:"parameters-9",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event-3",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"committed"'})}),"\n",(0,c.jsx)(s.p,{children:"The event name"}),"\n",(0,c.jsx)(s.h6,{id:"listener",children:"listener"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"args"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"The callback function"}),"\n",(0,c.jsx)(s.h5,{id:"returns-9",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"this"})}),"\n",(0,c.jsx)(s.p,{children:"this (for chaining)"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-6",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"off"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"listener"}),"): ",(0,c.jsx)(s.code,{children:"this"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L99",children:"libs/act/src/act.ts:99"})]}),"\n",(0,c.jsx)(s.p,{children:"Remove a listener for a lifecycle event."}),"\n",(0,c.jsx)(s.h5,{id:"parameters-10",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event-4",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"acked"'})}),"\n",(0,c.jsx)(s.p,{children:"The event name"}),"\n",(0,c.jsx)(s.h6,{id:"listener-1",children:"listener"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"args"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"The callback function"}),"\n",(0,c.jsx)(s.h5,{id:"returns-10",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"this"})}),"\n",(0,c.jsx)(s.p,{children:"this (for chaining)"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-7",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"off"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"listener"}),"): ",(0,c.jsx)(s.code,{children:"this"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L100",children:"libs/act/src/act.ts:100"})]}),"\n",(0,c.jsx)(s.p,{children:"Remove a listener for a lifecycle event."}),"\n",(0,c.jsx)(s.h5,{id:"parameters-11",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event-5",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"blocked"'})}),"\n",(0,c.jsx)(s.p,{children:"The event name"}),"\n",(0,c.jsx)(s.h6,{id:"listener-2",children:"listener"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"args"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"The callback function"}),"\n",(0,c.jsx)(s.h5,{id:"returns-11",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"this"})}),"\n",(0,c.jsx)(s.p,{children:"this (for chaining)"}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"on",children:"on()"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-8",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"on"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"listener"}),"): ",(0,c.jsx)(s.code,{children:"this"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L80",children:"libs/act/src/act.ts:80"})]}),"\n",(0,c.jsx)(s.p,{children:'Register a listener for a lifecycle event ("committed", "acked", or "blocked").'}),"\n",(0,c.jsx)(s.h5,{id:"parameters-12",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event-6",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"committed"'})}),"\n",(0,c.jsx)(s.p,{children:"The event name"}),"\n",(0,c.jsx)(s.h6,{id:"listener-3",children:"listener"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"args"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"The callback function"}),"\n",(0,c.jsx)(s.h5,{id:"returns-12",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"this"})}),"\n",(0,c.jsx)(s.p,{children:"this (for chaining)"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-9",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"on"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"listener"}),"): ",(0,c.jsx)(s.code,{children:"this"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L81",children:"libs/act/src/act.ts:81"})]}),"\n",(0,c.jsx)(s.p,{children:'Register a listener for a lifecycle event ("committed", "acked", or "blocked").'}),"\n",(0,c.jsx)(s.h5,{id:"parameters-13",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event-7",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"acked"'})}),"\n",(0,c.jsx)(s.p,{children:"The event name"}),"\n",(0,c.jsx)(s.h6,{id:"listener-4",children:"listener"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"args"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"The callback function"}),"\n",(0,c.jsx)(s.h5,{id:"returns-13",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"this"})}),"\n",(0,c.jsx)(s.p,{children:"this (for chaining)"}),"\n",(0,c.jsx)(s.h4,{id:"call-signature-10",children:"Call Signature"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"on"}),"(",(0,c.jsx)(s.code,{children:"event"}),", ",(0,c.jsx)(s.code,{children:"listener"}),"): ",(0,c.jsx)(s.code,{children:"this"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L82",children:"libs/act/src/act.ts:82"})]}),"\n",(0,c.jsx)(s.p,{children:'Register a listener for a lifecycle event ("committed", "acked", or "blocked").'}),"\n",(0,c.jsx)(s.h5,{id:"parameters-14",children:"Parameters"}),"\n",(0,c.jsx)(s.h6,{id:"event-8",children:"event"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:'"blocked"'})}),"\n",(0,c.jsx)(s.p,{children:"The event name"}),"\n",(0,c.jsx)(s.h6,{id:"listener-5",children:"listener"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"args"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"The callback function"}),"\n",(0,c.jsx)(s.h5,{id:"returns-14",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"this"})}),"\n",(0,c.jsx)(s.p,{children:"this (for chaining)"}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"query-1",children:"query()"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"query"}),"(",(0,c.jsx)(s.code,{children:"query"}),", ",(0,c.jsx)(s.code,{children:"callback?"}),"): ",(0,c.jsx)(s.code,{children:"Promise"}),"<{ ",(0,c.jsx)(s.code,{children:"count"}),": ",(0,c.jsx)(s.code,{children:"number"}),"; ",(0,c.jsx)(s.code,{children:"first?"}),": ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Committed",children:(0,c.jsx)(s.code,{children:"Committed"})}),"<",(0,c.jsx)(s.code,{children:"E"}),", keyof ",(0,c.jsx)(s.code,{children:"E"}),">; ",(0,c.jsx)(s.code,{children:"last?"}),": ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Committed",children:(0,c.jsx)(s.code,{children:"Committed"})}),"<",(0,c.jsx)(s.code,{children:"E"}),", keyof ",(0,c.jsx)(s.code,{children:"E"}),">; }>"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L346",children:"libs/act/src/act.ts:346"})]}),"\n",(0,c.jsx)(s.p,{children:"Queries the event store for events matching a filter."}),"\n",(0,c.jsx)(s.p,{children:"Use this for analyzing event streams, generating reports, or debugging.\nThe callback is invoked for each matching event, and the method returns\nsummary information (first event, last event, total count)."}),"\n",(0,c.jsxs)(s.p,{children:["For small result sets, consider using ",(0,c.jsx)(s.a,{href:"#query_array",children:"query_array"})," instead."]}),"\n",(0,c.jsx)(s.h4,{id:"parameters-15",children:"Parameters"}),"\n",(0,c.jsx)(s.h5,{id:"query-2",children:"query"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Query",children:(0,c.jsx)(s.code,{children:"Query"})})}),"\n",(0,c.jsx)(s.p,{children:"The query filter"}),"\n",(0,c.jsx)(s.h5,{id:"callback-2",children:"callback?"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"event"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"Optional callback invoked for each matching event"}),"\n",(0,c.jsx)(s.h4,{id:"returns-15",children:"Returns"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Promise"}),"<{ ",(0,c.jsx)(s.code,{children:"count"}),": ",(0,c.jsx)(s.code,{children:"number"}),"; ",(0,c.jsx)(s.code,{children:"first?"}),": ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Committed",children:(0,c.jsx)(s.code,{children:"Committed"})}),"<",(0,c.jsx)(s.code,{children:"E"}),", keyof ",(0,c.jsx)(s.code,{children:"E"}),">; ",(0,c.jsx)(s.code,{children:"last?"}),": ",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Committed",children:(0,c.jsx)(s.code,{children:"Committed"})}),"<",(0,c.jsx)(s.code,{children:"E"}),", keyof ",(0,c.jsx)(s.code,{children:"E"}),">; }>"]}),"\n",(0,c.jsx)(s.p,{children:"Object with first event, last event, and total count"}),"\n",(0,c.jsx)(s.h4,{id:"examples-5",children:"Examples"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const { first, last, count } = await app.query(\n  { stream: "counter-1" },\n  (event) => console.log(event.name, event.data)\n);\nconsole.log(`Found ${count} events from ${first?.id} to ${last?.id}`);\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const { count } = await app.query(\n  { name: "UserCreated", limit: 100 },\n  (event) => {\n    console.log("User created:", event.data.email);\n  }\n);\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000);\nconst { count } = await app.query({\n  created_after: yesterday,\n  stream: "user-123"\n});\nconsole.log(`User had ${count} events in last 24 hours`);\n'})}),"\n",(0,c.jsx)(s.h4,{id:"see-6",children:"See"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"#query_array",children:"query_array"})," for loading events into memory"]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"query_array",children:"query_array()"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"query_array"}),"(",(0,c.jsx)(s.code,{children:"query"}),"): ",(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Committed",children:(0,c.jsx)(s.code,{children:"Committed"})}),"<",(0,c.jsx)(s.code,{children:"E"}),", keyof ",(0,c.jsx)(s.code,{children:"E"}),">[]>"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L390",children:"libs/act/src/act.ts:390"})]}),"\n",(0,c.jsx)(s.p,{children:"Queries the event store and returns all matching events in memory."}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Use with caution"})," - this loads all results into memory. For large result sets,\nuse ",(0,c.jsx)(s.a,{href:"#query_array",children:"query"})," with a callback instead to process events incrementally."]}),"\n",(0,c.jsx)(s.h4,{id:"parameters-16",children:"Parameters"}),"\n",(0,c.jsx)(s.h5,{id:"query-3",children:"query"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Query",children:(0,c.jsx)(s.code,{children:"Query"})})}),"\n",(0,c.jsxs)(s.p,{children:["The query filter (same as ",(0,c.jsx)(s.a,{href:"#query_array",children:"query"}),")"]}),"\n",(0,c.jsx)(s.h4,{id:"returns-16",children:"Returns"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"Promise"}),"<",(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Committed",children:(0,c.jsx)(s.code,{children:"Committed"})}),"<",(0,c.jsx)(s.code,{children:"E"}),", keyof ",(0,c.jsx)(s.code,{children:"E"}),">[]>"]}),"\n",(0,c.jsx)(s.p,{children:"Array of all matching events"}),"\n",(0,c.jsx)(s.h4,{id:"examples-6",children:"Examples"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const events = await app.query_array({ stream: "counter-1" });\nconsole.log(`Loaded ${events.length} events`);\nevents.forEach(event => console.log(event.name, event.data));\n'})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:'const recent = await app.query_array({\n  stream: "user-123",\n  limit: 10\n});\n'})}),"\n",(0,c.jsx)(s.h4,{id:"see-7",children:"See"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"#query_array",children:"query"})," for large result sets"]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"start_correlations",children:"start_correlations()"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"start_correlations"}),"(",(0,c.jsx)(s.code,{children:"query?"}),", ",(0,c.jsx)(s.code,{children:"frequency?"}),", ",(0,c.jsx)(s.code,{children:"callback?"}),"): ",(0,c.jsx)(s.code,{children:"boolean"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L776",children:"libs/act/src/act.ts:776"})]}),"\n",(0,c.jsx)(s.p,{children:"Starts automatic periodic correlation worker for discovering new streams."}),"\n",(0,c.jsx)(s.p,{children:"The correlation worker runs in the background, scanning for new events and identifying\nnew target streams based on reaction resolvers. It maintains a sliding window that\nadvances with each scan, ensuring all events are eventually correlated."}),"\n",(0,c.jsx)(s.p,{children:"This is useful for dynamic stream creation patterns where you don't know all streams\nupfront - they're discovered as events arrive."}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Note:"})," Only one correlation worker can run at a time per Act instance."]}),"\n",(0,c.jsx)(s.h4,{id:"parameters-17",children:"Parameters"}),"\n",(0,c.jsx)(s.h5,{id:"query-4",children:"query?"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Query",children:(0,c.jsx)(s.code,{children:"Query"})})," = ",(0,c.jsx)(s.code,{children:"{}"})]}),"\n",(0,c.jsx)(s.p,{children:"Query filter for correlation scans"}),"\n",(0,c.jsx)(s.h5,{id:"frequency",children:"frequency?"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"number"})," = ",(0,c.jsx)(s.code,{children:"10_000"})]}),"\n",(0,c.jsx)(s.p,{children:"Correlation frequency in milliseconds (default: 10000)"}),"\n",(0,c.jsx)(s.h5,{id:"callback-3",children:"callback?"}),"\n",(0,c.jsxs)(s.p,{children:["(",(0,c.jsx)(s.code,{children:"leased"}),") => ",(0,c.jsx)(s.code,{children:"void"})]}),"\n",(0,c.jsx)(s.p,{children:"Optional callback invoked with newly discovered streams"}),"\n",(0,c.jsx)(s.h4,{id:"returns-17",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"boolean"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.code,{children:"true"})," if worker started, ",(0,c.jsx)(s.code,{children:"false"})," if already running"]}),"\n",(0,c.jsx)(s.h4,{id:"examples-7",children:"Examples"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:"// Start correlation worker scanning every 5 seconds\napp.start_correlations(\n  { after: 0, limit: 100 },\n  5000,\n  (leased) => {\n    console.log(`Discovered ${leased.length} new streams`);\n  }\n);\n\n// Later, stop it\napp.stop_correlations();\n"})}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:"// Load last checkpoint\nconst lastId = await loadCheckpoint();\n\napp.start_correlations(\n  { after: lastId, limit: 100 },\n  10000,\n  async (leased) => {\n    // Save checkpoint for next restart\n    if (leased.length) {\n      const maxId = Math.max(...leased.map(l => l.at));\n      await saveCheckpoint(maxId);\n    }\n  }\n);\n"})}),"\n",(0,c.jsx)(s.h4,{id:"see-8",children:"See"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"#correlate",children:"correlate"})," for manual one-time correlation"]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.a,{href:"#stop_correlations",children:"stop_correlations"})," to stop the worker"]}),"\n"]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"stop_correlations",children:"stop_correlations()"}),"\n",(0,c.jsxs)(s.blockquote,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"stop_correlations"}),"(): ",(0,c.jsx)(s.code,{children:"void"})]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Defined in: ",(0,c.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/9e65c8771b1ee16c4ff1a6a96f386e7bd4ffead8/libs/act/src/act.ts#L815",children:"libs/act/src/act.ts:815"})]}),"\n",(0,c.jsx)(s.p,{children:"Stops the automatic correlation worker."}),"\n",(0,c.jsxs)(s.p,{children:["Call this to stop the background correlation worker started by ",(0,c.jsx)(s.a,{href:"#start_correlations",children:"start_correlations"}),".\nThis is automatically called when the Act instance is disposed."]}),"\n",(0,c.jsx)(s.h4,{id:"returns-18",children:"Returns"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.code,{children:"void"})}),"\n",(0,c.jsx)(s.h4,{id:"example",children:"Example"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-typescript",children:"// Start correlation\napp.start_correlations();\n\n// Later, stop it\napp.stop_correlations();\n"})}),"\n",(0,c.jsx)(s.h4,{id:"see-9",children:"See"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.a,{href:"#start_correlations",children:"start_correlations"})})]})}function h(e={}){let{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,c.jsx)(s,{...e,children:(0,c.jsx)(o,{...e})}):o(e)}},3230(e,s,n){n.d(s,{R:()=>a,x:()=>i});var r=n(1299);let c={},t=r.createContext(c);function a(e){let s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:a(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);