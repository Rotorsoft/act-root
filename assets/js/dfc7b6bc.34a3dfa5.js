"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["7707"],{9398(e,n,t){t.r(n),t.d(n,{metadata:()=>s,default:()=>h,frontMatter:()=>r,contentTitle:()=>a,toc:()=>l,assets:()=>d});var s=JSON.parse('{"id":"api/act/src/type-aliases/ActionBuilder","title":"ActionBuilder","description":"@rotorsoft/act-root","source":"@site/docs/api/act/src/type-aliases/ActionBuilder.md","sourceDirName":"api/act/src/type-aliases","slug":"/api/act/src/type-aliases/ActionBuilder","permalink":"/act-root/docs/api/act/src/type-aliases/ActionBuilder","draft":false,"unlisted":false,"editUrl":"https://github.com/rotorsoft/act-root/edit/master/docs/docs/api/act/src/type-aliases/ActionBuilder.md","tags":[],"version":"current","frontMatter":{}}'),c=t(6259),i=t(3230);let r={},a,d={},l=[{value:"See",id:"see",level:2},{value:"Type Parameters",id:"type-parameters",level:2},{value:"TState",id:"tstate",level:3},{value:"TEvents",id:"tevents",level:3},{value:"TActions",id:"tactions",level:3},{value:"TName",id:"tname",level:3},{value:"Properties",id:"properties",level:2},{value:"build()",id:"build",level:3},{value:"Returns",id:"returns",level:4},{value:"Example",id:"example",level:4},{value:"on()",id:"on",level:3},{value:"Type Parameters",id:"type-parameters-1",level:4},{value:"TKey",id:"tkey",level:5},{value:"TNewActions",id:"tnewactions",level:5},{value:"Parameters",id:"parameters",level:4},{value:"entry",id:"entry",level:5},{value:"Returns",id:"returns-1",level:4},{value:"emit()",id:"emit",level:5},{value:"Parameters",id:"parameters-1",level:6},{value:"handler",id:"handler",level:6},{value:"Returns",id:"returns-2",level:6},{value:"Examples",id:"examples",level:6},{value:"given()",id:"given",level:5},{value:"Parameters",id:"parameters-2",level:6},{value:"rules",id:"rules",level:6},{value:"Returns",id:"returns-3",level:6},{value:"emit()",id:"emit-1",level:6},{value:"Parameters",id:"parameters-3",level:6},{value:"handler",id:"handler-1",level:6},{value:"Returns",id:"returns-4",level:6},{value:"Examples",id:"examples-1",level:6},{value:"Example",id:"example-1",level:6},{value:"Examples",id:"examples-2",level:4},{value:"snap()",id:"snap",level:3},{value:"Parameters",id:"parameters-4",level:4},{value:"snap",id:"snap-1",level:5},{value:"Returns",id:"returns-5",level:4},{value:"Examples",id:"examples-3",level:4}];function o(e){let n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"/act-root/docs/api/",children:(0,c.jsx)(n.strong,{children:"@rotorsoft/act-root"})})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.a,{href:"/act-root/docs/api/",children:"@rotorsoft/act-root"})," / ",(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/",children:"act/src"})," / ActionBuilder"]}),"\n",(0,c.jsx)(n.h1,{id:"type-alias-actionbuildertstate-tevents-tactions-tname",children:"Type Alias: ActionBuilder<TState, TEvents, TActions, TName>"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"ActionBuilder"}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"}),", ",(0,c.jsx)(n.code,{children:"TName"}),"> = ",(0,c.jsx)(n.code,{children:"object"})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Defined in: ",(0,c.jsx)(n.a,{href:"https://github.com/Rotorsoft/act-root/blob/60e27df516fbb7812e8ed848e4e5481cb3c59fc6/libs/act/src/state-builder.ts#L137",children:"libs/act/src/state-builder.ts:137"})]}),"\n",(0,c.jsx)(n.p,{children:"Builder interface for defining actions (commands) on a state."}),"\n",(0,c.jsx)(n.p,{children:"Actions represent user/system intents to modify state. Each action is validated\nagainst a schema, can have business rule invariants, and must emit one or more events."}),"\n",(0,c.jsx)(n.h2,{id:"see",children:"See"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/functions/state",children:"state"})," for complete usage examples"]}),"\n",(0,c.jsx)(n.h2,{id:"type-parameters",children:"Type Parameters"}),"\n",(0,c.jsx)(n.h3,{id:"tstate",children:"TState"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"TState"})," ",(0,c.jsx)(n.em,{children:"extends"})," ",(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/Schema",children:(0,c.jsx)(n.code,{children:"Schema"})})]}),"\n",(0,c.jsx)(n.p,{children:"State schema type"}),"\n",(0,c.jsx)(n.h3,{id:"tevents",children:"TEvents"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"TEvents"})," ",(0,c.jsx)(n.em,{children:"extends"})," ",(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,c.jsx)(n.code,{children:"Schemas"})})]}),"\n",(0,c.jsx)(n.p,{children:"Event schemas type"}),"\n",(0,c.jsx)(n.h3,{id:"tactions",children:"TActions"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"TActions"})," ",(0,c.jsx)(n.em,{children:"extends"})," ",(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,c.jsx)(n.code,{children:"Schemas"})})]}),"\n",(0,c.jsx)(n.p,{children:"Action schemas type"}),"\n",(0,c.jsx)(n.h3,{id:"tname",children:"TName"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"TName"})," ",(0,c.jsx)(n.em,{children:"extends"})," ",(0,c.jsx)(n.code,{children:"string"})," = ",(0,c.jsx)(n.code,{children:"string"})]}),"\n",(0,c.jsx)(n.p,{children:"State name literal type"}),"\n",(0,c.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,c.jsx)(n.h3,{id:"build",children:"build()"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"build"}),": () => ",(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/State",children:(0,c.jsx)(n.code,{children:"State"})}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"}),", ",(0,c.jsx)(n.code,{children:"TName"}),">"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Defined in: ",(0,c.jsx)(n.a,{href:"https://github.com/Rotorsoft/act-root/blob/60e27df516fbb7812e8ed848e4e5481cb3c59fc6/libs/act/src/state-builder.ts#L336",children:"libs/act/src/state-builder.ts:336"})]}),"\n",(0,c.jsx)(n.p,{children:"Finalizes and builds the state definition."}),"\n",(0,c.jsx)(n.p,{children:"Call this method after defining all actions, invariants, and patches to create\nthe complete State object that can be registered with Act."}),"\n",(0,c.jsx)(n.h4,{id:"returns",children:"Returns"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/State",children:(0,c.jsx)(n.code,{children:"State"})}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"}),", ",(0,c.jsx)(n.code,{children:"TName"}),">"]}),"\n",(0,c.jsx)(n.p,{children:"The complete strongly-typed State definition"}),"\n",(0,c.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'const Counter = state({ Counter: schema })\n  .init(() => ({ count: 0 }))\n  .emits({ Incremented: z.object({ amount: z.number() }) })\n  .patch({ Incremented: ({ data }, state) => ({ count: state.count + data.amount }) })\n  .on({ increment: z.object({ by: z.number() }) })\n    .emit((action) => ["Incremented", { amount: action.by }])\n  .build(); // Returns State<TState, TEvents, TActions, TName>\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"on",children:"on()"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"on"}),": <",(0,c.jsx)(n.code,{children:"TKey"}),", ",(0,c.jsx)(n.code,{children:"TNewActions"}),">(",(0,c.jsx)(n.code,{children:"entry"}),") => ",(0,c.jsx)(n.code,{children:"object"})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Defined in: ",(0,c.jsx)(n.a,{href:"https://github.com/Rotorsoft/act-root/blob/60e27df516fbb7812e8ed848e4e5481cb3c59fc6/libs/act/src/state-builder.ts#L182",children:"libs/act/src/state-builder.ts:182"})]}),"\n",(0,c.jsx)(n.p,{children:"Defines an action (command) that can be executed on this state."}),"\n",(0,c.jsx)(n.p,{children:'Actions represent intents to change state - they should be named in imperative form\n(e.g., "CreateUser", "IncrementCounter", "PlaceOrder"). Actions are validated against\ntheir schema and must emit at least one event.'}),"\n",(0,c.jsxs)(n.p,{children:["Pass a ",(0,c.jsx)(n.code,{children:"{ ActionName: schema }"})," record \u2014 use shorthand ",(0,c.jsx)(n.code,{children:"{ ActionName }"}),"\nwhen the variable name matches the action name. The key becomes the\naction name, the value the Zod schema."]}),"\n",(0,c.jsx)(n.h4,{id:"type-parameters-1",children:"Type Parameters"}),"\n",(0,c.jsx)(n.h5,{id:"tkey",children:"TKey"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"TKey"})," ",(0,c.jsx)(n.em,{children:"extends"})," ",(0,c.jsx)(n.code,{children:"string"})]}),"\n",(0,c.jsx)(n.p,{children:"Action name (string literal type)"}),"\n",(0,c.jsx)(n.h5,{id:"tnewactions",children:"TNewActions"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"TNewActions"})," ",(0,c.jsx)(n.em,{children:"extends"})," ",(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/Schema",children:(0,c.jsx)(n.code,{children:"Schema"})})]}),"\n",(0,c.jsx)(n.p,{children:"Action payload schema type"}),"\n",(0,c.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,c.jsx)(n.h5,{id:"entry",children:"entry"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"ActionEntry"}),"<",(0,c.jsx)(n.code,{children:"TKey"}),", ",(0,c.jsx)(n.code,{children:"TNewActions"}),">"]}),"\n",(0,c.jsxs)(n.p,{children:["Single-key record ",(0,c.jsx)(n.code,{children:"{ ActionName: schema }"})]}),"\n",(0,c.jsx)(n.h4,{id:"returns-1",children:"Returns"}),"\n",(0,c.jsxs)(n.p,{children:["An object with ",(0,c.jsx)(n.code,{children:".given()"})," and ",(0,c.jsx)(n.code,{children:".emit()"})," for further configuration"]}),"\n",(0,c.jsx)(n.h5,{id:"emit",children:"emit()"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"emit"}),": (",(0,c.jsx)(n.code,{children:"handler"}),") => ",(0,c.jsx)(n.code,{children:"ActionBuilder"}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"})," & ",(0,c.jsx)(n.code,{children:"{ [P in TKey]: TNewActions }"}),", ",(0,c.jsx)(n.code,{children:"TName"}),">"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Defines the action handler that emits events."}),"\n",(0,c.jsxs)(n.p,{children:["The handler receives the action payload and current state snapshot,\nand must return one or more events to emit. Return a single event as\n",(0,c.jsx)(n.code,{children:'["EventName", data]'})," or multiple events as an array of event tuples."]}),"\n",(0,c.jsx)(n.p,{children:"Pass a string event name for passthrough: the action payload becomes\nthe event data directly."}),"\n",(0,c.jsx)(n.h6,{id:"parameters-1",children:"Parameters"}),"\n",(0,c.jsx)(n.h6,{id:"handler",children:"handler"}),"\n",(0,c.jsx)(n.p,{children:"Function that returns events to emit, or event name string for passthrough"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/ActionHandler",children:(0,c.jsx)(n.code,{children:"ActionHandler"})}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"{ [P in TKey]: TNewActions }"}),", ",(0,c.jsx)(n.code,{children:"TKey"}),"> | keyof ",(0,c.jsx)(n.code,{children:"TEvents"})," & ",(0,c.jsx)(n.code,{children:"string"})]}),"\n",(0,c.jsx)(n.h6,{id:"returns-2",children:"Returns"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"ActionBuilder"}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"})," & ",(0,c.jsx)(n.code,{children:"{ [P in TKey]: TNewActions }"}),", ",(0,c.jsx)(n.code,{children:"TName"}),">"]}),"\n",(0,c.jsx)(n.p,{children:"The ActionBuilder for chaining more actions"}),"\n",(0,c.jsx)(n.h6,{id:"examples",children:"Examples"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'.emit("Incremented")\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'.emit((action) => ["Incremented", { amount: action.by }])\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'.emit((action) => [\n  ["Incremented", { amount: action.by }],\n  ["LogUpdated", { message: `Incremented by ${action.by}` }]\n])\n'})}),"\n",(0,c.jsx)(n.h5,{id:"given",children:"given()"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"given"}),": (",(0,c.jsx)(n.code,{children:"rules"}),") => ",(0,c.jsx)(n.code,{children:"object"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Adds business rule invariants that must hold before the action can execute."}),"\n",(0,c.jsxs)(n.p,{children:["Invariants are checked after loading the current state but before emitting events.\nEach invariant should return ",(0,c.jsx)(n.code,{children:"true"})," or an error message string. All invariants\nmust pass for the action to succeed."]}),"\n",(0,c.jsx)(n.h6,{id:"parameters-2",children:"Parameters"}),"\n",(0,c.jsx)(n.h6,{id:"rules",children:"rules"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/Invariant",children:(0,c.jsx)(n.code,{children:"Invariant"})}),"<",(0,c.jsx)(n.code,{children:"TState"}),">[]"]}),"\n",(0,c.jsx)(n.p,{children:"Array of invariant functions"}),"\n",(0,c.jsx)(n.h6,{id:"returns-3",children:"Returns"}),"\n",(0,c.jsxs)(n.p,{children:["An object with ",(0,c.jsx)(n.code,{children:".emit()"})," to finalize the action"]}),"\n",(0,c.jsx)(n.h6,{id:"emit-1",children:"emit()"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"emit"}),": (",(0,c.jsx)(n.code,{children:"handler"}),") => ",(0,c.jsx)(n.code,{children:"ActionBuilder"}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"})," & ",(0,c.jsx)(n.code,{children:"{ [P in TKey]: TNewActions }"}),", ",(0,c.jsx)(n.code,{children:"TName"}),">"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Defines the action handler that emits events."}),"\n",(0,c.jsx)(n.p,{children:"The handler receives the action payload and current state snapshot,\nand must return one or more events to emit. Events are applied to state\nvia the patch handlers defined earlier."}),"\n",(0,c.jsx)(n.p,{children:"Pass a string event name for passthrough: the action payload becomes\nthe event data directly."}),"\n",(0,c.jsx)(n.h6,{id:"parameters-3",children:"Parameters"}),"\n",(0,c.jsx)(n.h6,{id:"handler-1",children:"handler"}),"\n",(0,c.jsx)(n.p,{children:"Function that returns events to emit, or event name string for passthrough"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.a,{href:"/act-root/docs/api/act/src/type-aliases/ActionHandler",children:(0,c.jsx)(n.code,{children:"ActionHandler"})}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"{ [P in TKey]: TNewActions }"}),", ",(0,c.jsx)(n.code,{children:"TKey"}),"> | keyof ",(0,c.jsx)(n.code,{children:"TEvents"})," & ",(0,c.jsx)(n.code,{children:"string"})]}),"\n",(0,c.jsx)(n.h6,{id:"returns-4",children:"Returns"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"ActionBuilder"}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"})," & ",(0,c.jsx)(n.code,{children:"{ [P in TKey]: TNewActions }"}),", ",(0,c.jsx)(n.code,{children:"TName"}),">"]}),"\n",(0,c.jsx)(n.p,{children:"The ActionBuilder for chaining more actions"}),"\n",(0,c.jsx)(n.h6,{id:"examples-1",children:"Examples"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'.emit((action, snapshot) => {\n  const newBalance = snapshot.state.balance + action.amount;\n  return ["Deposited", { amount: action.amount, newBalance }];\n})\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'.emit("TicketAssigned")\n'})}),"\n",(0,c.jsx)(n.h6,{id:"example-1",children:"Example"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'.given([\n  (_, snap) => snap.state.status === "active" || "Must be active",\n  (target, snap) => snap.state.ownerId === target.actor.id || "Not authorized"\n])\n'})}),"\n",(0,c.jsx)(n.h4,{id:"examples-2",children:"Examples"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'.on({ increment: z.object({ by: z.number() }) })\n  .emit((action) => ["Incremented", { amount: action.by }])\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'.on({ withdraw: z.object({ amount: z.number() }) })\n  .given([\n    (_, snap) => snap.state.balance >= 0 || "Account closed",\n    (_, snap, action) => snap.state.balance >= action.amount || "Insufficient funds"\n  ])\n  .emit((action) => ["Withdrawn", { amount: action.amount }])\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'const OpenTicket = z.object({ title: z.string() });\n.on({ OpenTicket })\n  .emit((action) => ["TicketOpened", { title: action.title }])\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"snap",children:"snap()"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"snap"}),": (",(0,c.jsx)(n.code,{children:"snap"}),") => ",(0,c.jsx)(n.code,{children:"ActionBuilder"}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"}),", ",(0,c.jsx)(n.code,{children:"TName"}),">"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Defined in: ",(0,c.jsx)(n.a,{href:"https://github.com/Rotorsoft/act-root/blob/60e27df516fbb7812e8ed848e4e5481cb3c59fc6/libs/act/src/state-builder.ts#L314",children:"libs/act/src/state-builder.ts:314"})]}),"\n",(0,c.jsx)(n.p,{children:"Defines a snapshotting strategy to optimize state reconstruction."}),"\n",(0,c.jsxs)(n.p,{children:["Snapshots store the current state at a point in time, allowing faster state loading\nby avoiding replaying all events from the beginning. The snap function is called\nafter each event is applied and should return ",(0,c.jsx)(n.code,{children:"true"})," when a snapshot should be taken."]}),"\n",(0,c.jsx)(n.h4,{id:"parameters-4",children:"Parameters"}),"\n",(0,c.jsx)(n.h5,{id:"snap-1",children:"snap"}),"\n",(0,c.jsxs)(n.p,{children:["(",(0,c.jsx)(n.code,{children:"snapshot"}),") => ",(0,c.jsx)(n.code,{children:"boolean"})]}),"\n",(0,c.jsx)(n.p,{children:"Predicate function that returns true when a snapshot should be taken"}),"\n",(0,c.jsx)(n.h4,{id:"returns-5",children:"Returns"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"ActionBuilder"}),"<",(0,c.jsx)(n.code,{children:"TState"}),", ",(0,c.jsx)(n.code,{children:"TEvents"}),", ",(0,c.jsx)(n.code,{children:"TActions"}),", ",(0,c.jsx)(n.code,{children:"TName"}),">"]}),"\n",(0,c.jsx)(n.p,{children:"The ActionBuilder for chaining"}),"\n",(0,c.jsx)(n.h4,{id:"examples-3",children:"Examples"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:".snap((snapshot) => snapshot.patches >= 10)\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:".snap((snapshot) => {\n  const estimatedSize = JSON.stringify(snapshot.state).length;\n  return estimatedSize > 10000 || snapshot.patches >= 50;\n})\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:".snap((snapshot) => {\n  const hoursSinceLastSnapshot = snapshot.patches * 0.1; // Estimate\n  return hoursSinceLastSnapshot >= 24;\n})\n"})})]})}function h(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(o,{...e})}):o(e)}},3230(e,n,t){t.d(n,{R:()=>r,x:()=>a});var s=t(1299);let c={},i=s.createContext(c);function r(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);