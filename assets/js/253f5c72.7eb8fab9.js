"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["1641"],{4223(e,t,n){n.r(t),n.d(t,{metadata:()=>s,default:()=>o,frontMatter:()=>i,contentTitle:()=>a,toc:()=>l,assets:()=>d});var s=JSON.parse('{"id":"api/act/src/type-aliases/StateBuilder","title":"StateBuilder","description":"@rotorsoft/act-root","source":"@site/docs/api/act/src/type-aliases/StateBuilder.md","sourceDirName":"api/act/src/type-aliases","slug":"/api/act/src/type-aliases/StateBuilder","permalink":"/act-root/docs/api/act/src/type-aliases/StateBuilder","draft":false,"unlisted":false,"editUrl":"https://github.com/rotorsoft/act-root/edit/master/docs/docs/api/act/src/type-aliases/StateBuilder.md","tags":[],"version":"current","frontMatter":{}}'),r=n(6259),c=n(5731);let i={},a,d={},l=[{value:"See",id:"see",level:2},{value:"Type Parameters",id:"type-parameters",level:2},{value:"S",id:"s",level:3},{value:"N",id:"n",level:3},{value:"Properties",id:"properties",level:2},{value:"init()",id:"init",level:3},{value:"Parameters",id:"parameters",level:4},{value:"init",id:"init-1",level:5},{value:"Returns",id:"returns",level:4},{value:"emits()",id:"emits",level:5},{value:"Type Parameters",id:"type-parameters-1",level:6},{value:"E",id:"e",level:6},{value:"Parameters",id:"parameters-1",level:6},{value:"events",id:"events",level:6},{value:"Returns",id:"returns-1",level:6},{value:"patch()",id:"patch",level:6},{value:"Parameters",id:"parameters-2",level:6},{value:"patch",id:"patch-1",level:6},{value:"Returns",id:"returns-2",level:6},{value:"Example",id:"example",level:6},{value:"Example",id:"example-1",level:6},{value:"Examples",id:"examples",level:4}];function h(e){let t={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"/act-root/docs/api/",children:(0,r.jsx)(t.strong,{children:"@rotorsoft/act-root"})})}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"/act-root/docs/api/",children:"@rotorsoft/act-root"})," / ",(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/",children:"act/src"})," / StateBuilder"]}),"\n",(0,r.jsx)(t.h1,{id:"type-alias-statebuilders-n",children:"Type Alias: StateBuilder<S, N>"}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"StateBuilder"}),"<",(0,r.jsx)(t.code,{children:"S"}),", ",(0,r.jsx)(t.code,{children:"N"}),"> = ",(0,r.jsx)(t.code,{children:"object"})]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["Defined in: ",(0,r.jsx)(t.a,{href:"https://github.com/Rotorsoft/act-root/blob/10a89f5de6abebe361aacae13d12e78029831ecf/libs/act/src/state-builder.ts#L32",children:"libs/act/src/state-builder.ts:32"})]}),"\n",(0,r.jsx)(t.p,{children:"Builder interface for defining a state with event sourcing."}),"\n",(0,r.jsx)(t.p,{children:"Provides a fluent API to configure the initial state, event types,\nand event handlers (reducers) before moving to action configuration."}),"\n",(0,r.jsx)(t.h2,{id:"see",children:"See"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/functions/state",children:"state"})," for usage examples"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/type-aliases/ActionBuilder",children:"ActionBuilder"})," for action configuration"]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"type-parameters",children:"Type Parameters"}),"\n",(0,r.jsx)(t.h3,{id:"s",children:"S"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"S"})," ",(0,r.jsx)(t.em,{children:"extends"})," ",(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/type-aliases/Schema",children:(0,r.jsx)(t.code,{children:"Schema"})})]}),"\n",(0,r.jsx)(t.p,{children:"State schema type"}),"\n",(0,r.jsx)(t.h3,{id:"n",children:"N"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"N"})," ",(0,r.jsx)(t.em,{children:"extends"})," ",(0,r.jsx)(t.code,{children:"string"})," = ",(0,r.jsx)(t.code,{children:"string"})]}),"\n",(0,r.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(t.h3,{id:"init",children:"init()"}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"init"}),": (",(0,r.jsx)(t.code,{children:"init"}),") => ",(0,r.jsx)(t.code,{children:"object"})]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["Defined in: ",(0,r.jsx)(t.a,{href:"https://github.com/Rotorsoft/act-root/blob/10a89f5de6abebe361aacae13d12e78029831ecf/libs/act/src/state-builder.ts#L52",children:"libs/act/src/state-builder.ts:52"})]}),"\n",(0,r.jsx)(t.p,{children:"Defines the initial state for new state instances."}),"\n",(0,r.jsx)(t.p,{children:"The init function is called when a new stream is created (first event).\nIt can accept initial data or return a default state."}),"\n",(0,r.jsx)(t.h4,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(t.h5,{id:"init-1",children:"init"}),"\n",(0,r.jsxs)(t.p,{children:["() => ",(0,r.jsx)(t.code,{children:"Readonly"}),"<",(0,r.jsx)(t.code,{children:"S"}),">"]}),"\n",(0,r.jsx)(t.p,{children:"Function returning the initial state"}),"\n",(0,r.jsx)(t.h4,{id:"returns",children:"Returns"}),"\n",(0,r.jsxs)(t.p,{children:["A builder with ",(0,r.jsx)(t.code,{children:".emits()"})," to declare event types"]}),"\n",(0,r.jsx)(t.h5,{id:"emits",children:"emits()"}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"emits"}),": <",(0,r.jsx)(t.code,{children:"E"}),">(",(0,r.jsx)(t.code,{children:"events"}),") => ",(0,r.jsx)(t.code,{children:"object"})]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Declares the event types that this state can emit."}),"\n",(0,r.jsx)(t.p,{children:"Events represent facts that have happened - they should be named in past tense.\nEach event is defined with a Zod schema for type safety and runtime validation."}),"\n",(0,r.jsx)(t.h6,{id:"type-parameters-1",children:"Type Parameters"}),"\n",(0,r.jsx)(t.h6,{id:"e",children:"E"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"E"})," ",(0,r.jsx)(t.em,{children:"extends"})," ",(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,r.jsx)(t.code,{children:"Schemas"})})]}),"\n",(0,r.jsx)(t.p,{children:"Event schemas type"}),"\n",(0,r.jsx)(t.h6,{id:"parameters-1",children:"Parameters"}),"\n",(0,r.jsx)(t.h6,{id:"events",children:"events"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/type-aliases/ZodTypes",children:(0,r.jsx)(t.code,{children:"ZodTypes"})}),"<",(0,r.jsx)(t.code,{children:"E"}),">"]}),"\n",(0,r.jsx)(t.p,{children:"Object mapping event names to Zod schemas"}),"\n",(0,r.jsx)(t.h6,{id:"returns-1",children:"Returns"}),"\n",(0,r.jsxs)(t.p,{children:["A builder with ",(0,r.jsx)(t.code,{children:".patch()"})," to define event handlers"]}),"\n",(0,r.jsx)(t.h6,{id:"patch",children:"patch()"}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"patch"}),": (",(0,r.jsx)(t.code,{children:"patch"}),") => ",(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/type-aliases/ActionBuilder",children:(0,r.jsx)(t.code,{children:"ActionBuilder"})}),"<",(0,r.jsx)(t.code,{children:"S"}),", ",(0,r.jsx)(t.code,{children:"E"}),", ",(0,r.jsx)(t.code,{children:"Record"}),"<",(0,r.jsx)(t.code,{children:"string"}),", ",(0,r.jsx)(t.code,{children:"never"}),">, ",(0,r.jsx)(t.code,{children:"N"}),">"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Defines how each event updates (patches) the state."}),"\n",(0,r.jsx)(t.p,{children:"Patch handlers are reducers - pure functions that take an event and current state,\nand return the changes to apply. Return partial state objects; unchanged fields\nare preserved automatically."}),"\n",(0,r.jsx)(t.h6,{id:"parameters-2",children:"Parameters"}),"\n",(0,r.jsx)(t.h6,{id:"patch-1",children:"patch"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/type-aliases/PatchHandlers",children:(0,r.jsx)(t.code,{children:"PatchHandlers"})}),"<",(0,r.jsx)(t.code,{children:"S"}),", ",(0,r.jsx)(t.code,{children:"E"}),">"]}),"\n",(0,r.jsx)(t.p,{children:"Object mapping event names to patch handler functions"}),"\n",(0,r.jsx)(t.h6,{id:"returns-2",children:"Returns"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"/act-root/docs/api/act/src/type-aliases/ActionBuilder",children:(0,r.jsx)(t.code,{children:"ActionBuilder"})}),"<",(0,r.jsx)(t.code,{children:"S"}),", ",(0,r.jsx)(t.code,{children:"E"}),", ",(0,r.jsx)(t.code,{children:"Record"}),"<",(0,r.jsx)(t.code,{children:"string"}),", ",(0,r.jsx)(t.code,{children:"never"}),">, ",(0,r.jsx)(t.code,{children:"N"}),">"]}),"\n",(0,r.jsx)(t.p,{children:"An ActionBuilder for defining actions"}),"\n",(0,r.jsx)(t.h6,{id:"example",children:"Example"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:".patch({\n  Incremented: (event, state) => ({ count: state.count + event.data.amount }),\n  Decremented: (event, state) => ({ count: state.count - event.data.amount }),\n  Reset: () => ({ count: 0 })\n})\n"})}),"\n",(0,r.jsx)(t.h6,{id:"example-1",children:"Example"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:".emits({\n  Incremented: z.object({ amount: z.number() }),\n  Decremented: z.object({ amount: z.number() }),\n  Reset: z.object({})\n})\n"})}),"\n",(0,r.jsx)(t.h4,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:".init(() => ({ count: 0, created: new Date() }))\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:".init((data) => ({ ...data, createdAt: new Date() }))\n"})})]})}function o(e={}){let{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},5731(e,t,n){n.d(t,{R:()=>i,x:()=>a});var s=n(1299);let r={},c=s.createContext(r);function i(e){let t=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(c.Provider,{value:t},e.children)}}}]);