"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["4646"],{4035(e,s,n){n.r(s),n.d(s,{metadata:()=>c,default:()=>h,frontMatter:()=>i,contentTitle:()=>d,toc:()=>l,assets:()=>a});var c=JSON.parse('{"id":"api/act/src/type-aliases/ActBuilder","title":"ActBuilder","description":"@rotorsoft/act-root","source":"@site/docs/api/act/src/type-aliases/ActBuilder.md","sourceDirName":"api/act/src/type-aliases","slug":"/api/act/src/type-aliases/ActBuilder","permalink":"/act-root/docs/api/act/src/type-aliases/ActBuilder","draft":false,"unlisted":false,"editUrl":"https://github.com/rotorsoft/act-root/edit/master/docs/docs/api/act/src/type-aliases/ActBuilder.md","tags":[],"version":"current","frontMatter":{}}'),r=n(6259),t=n(5731);let i={},d,a={},l=[{value:"See",id:"see",level:2},{value:"Type Parameters",id:"type-parameters",level:2},{value:"S",id:"s",level:3},{value:"E",id:"e",level:3},{value:"A",id:"a",level:3},{value:"Properties",id:"properties",level:2},{value:"build()",id:"build",level:3},{value:"Parameters",id:"parameters",level:4},{value:"drainLimit?",id:"drainlimit",level:5},{value:"Returns",id:"returns",level:4},{value:"Example",id:"example",level:4},{value:"See",id:"see-1",level:4},{value:"events",id:"events",level:3},{value:"on()",id:"on",level:3},{value:"Type Parameters",id:"type-parameters-1",level:4},{value:"K",id:"k",level:5},{value:"Parameters",id:"parameters-1",level:4},{value:"event",id:"event",level:5},{value:"Returns",id:"returns-1",level:4},{value:"do()",id:"do",level:5},{value:"Parameters",id:"parameters-2",level:6},{value:"handler",id:"handler",level:6},{value:"options?",id:"options",level:6},{value:"Returns",id:"returns-2",level:6},{value:"Examples",id:"examples",level:6},{value:"Example",id:"example-1",level:4},{value:"with()",id:"with",level:3},{value:"Type Parameters",id:"type-parameters-2",level:4},{value:"SX",id:"sx",level:5},{value:"EX",id:"ex",level:5},{value:"AX",id:"ax",level:5},{value:"Parameters",id:"parameters-3",level:4},{value:"state",id:"state",level:5},{value:"Returns",id:"returns-3",level:4},{value:"Throws",id:"throws",level:4},{value:"Examples",id:"examples-1",level:4}];function o(e){let s={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"/act-root/docs/api/",children:(0,r.jsx)(s.strong,{children:"@rotorsoft/act-root"})})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.a,{href:"/act-root/docs/api/",children:"@rotorsoft/act-root"})," / ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/",children:"act/src"})," / ActBuilder"]}),"\n",(0,r.jsx)(s.h1,{id:"type-alias-actbuilders-e-a",children:"Type Alias: ActBuilder<S, E, A>"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"ActBuilder"}),"<",(0,r.jsx)(s.code,{children:"S"}),", ",(0,r.jsx)(s.code,{children:"E"}),", ",(0,r.jsx)(s.code,{children:"A"}),"> = ",(0,r.jsx)(s.code,{children:"object"})]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Defined in: ",(0,r.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/b39cb913cd626c8cebba8033cf5dffce85f27baa/libs/act/src/act-builder.ts#L44",children:"libs/act/src/act-builder.ts:44"})]}),"\n",(0,r.jsx)(s.p,{children:"Fluent builder interface for composing event-sourced applications."}),"\n",(0,r.jsx)(s.p,{children:"Provides a chainable API for:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Registering states via ",(0,r.jsx)(s.code,{children:".with()"})]}),"\n",(0,r.jsxs)(s.li,{children:["Defining event reactions via ",(0,r.jsx)(s.code,{children:".on()"})," \u2192 ",(0,r.jsx)(s.code,{children:".do()"})," \u2192 ",(0,r.jsx)(s.code,{children:".to()"})," or ",(0,r.jsx)(s.code,{children:".void()"})]}),"\n",(0,r.jsxs)(s.li,{children:["Building the orchestrator via ",(0,r.jsx)(s.code,{children:".build()"})]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"see",children:"See"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/functions/act",children:"act"})," for usage examples"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/classes/Act",children:"Act"})," for the built orchestrator API"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"type-parameters",children:"Type Parameters"}),"\n",(0,r.jsx)(s.h3,{id:"s",children:"S"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"S"})," ",(0,r.jsx)(s.em,{children:"extends"})," ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/SchemaRegister",children:(0,r.jsx)(s.code,{children:"SchemaRegister"})}),"<",(0,r.jsx)(s.code,{children:"A"}),">"]}),"\n",(0,r.jsx)(s.p,{children:"Schema register for states (maps action names to state schemas)"}),"\n",(0,r.jsx)(s.h3,{id:"e",children:"E"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"E"})," ",(0,r.jsx)(s.em,{children:"extends"})," ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,r.jsx)(s.code,{children:"Schemas"})})]}),"\n",(0,r.jsx)(s.p,{children:"Event schemas (maps event names to event data schemas)"}),"\n",(0,r.jsx)(s.h3,{id:"a",children:"A"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"A"})," ",(0,r.jsx)(s.em,{children:"extends"})," ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,r.jsx)(s.code,{children:"Schemas"})})]}),"\n",(0,r.jsx)(s.p,{children:"Action schemas (maps action names to action payload schemas)"}),"\n",(0,r.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(s.h3,{id:"build",children:"build()"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"build"}),": (",(0,r.jsx)(s.code,{children:"drainLimit?"}),") => ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/classes/Act",children:(0,r.jsx)(s.code,{children:"Act"})}),"<",(0,r.jsx)(s.code,{children:"S"}),", ",(0,r.jsx)(s.code,{children:"E"}),", ",(0,r.jsx)(s.code,{children:"A"}),">"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Defined in: ",(0,r.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/b39cb913cd626c8cebba8033cf5dffce85f27baa/libs/act/src/act-builder.ts#L241",children:"libs/act/src/act-builder.ts:241"})]}),"\n",(0,r.jsx)(s.p,{children:"Builds and returns the Act orchestrator instance."}),"\n",(0,r.jsx)(s.p,{children:"This finalizes the builder configuration and creates the orchestrator that\ncan execute actions, load state, and process reactions."}),"\n",(0,r.jsx)(s.h4,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(s.h5,{id:"drainlimit",children:"drainLimit?"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"number"})}),"\n",(0,r.jsx)(s.p,{children:"Deprecated parameter, no longer used"}),"\n",(0,r.jsx)(s.h4,{id:"returns",children:"Returns"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/classes/Act",children:(0,r.jsx)(s.code,{children:"Act"})}),"<",(0,r.jsx)(s.code,{children:"S"}),", ",(0,r.jsx)(s.code,{children:"E"}),", ",(0,r.jsx)(s.code,{children:"A"}),">"]}),"\n",(0,r.jsx)(s.p,{children:"The Act orchestrator instance"}),"\n",(0,r.jsx)(s.h4,{id:"example",children:"Example"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:'const app = act()\n  .with(Counter)\n  .with(User)\n  .on("UserCreated")\n    .do(sendWelcomeEmail)\n    .void()\n  .build();\n\n// Now use the app\nawait app.do("createUser", target, payload);\nawait app.drain();\n'})}),"\n",(0,r.jsx)(s.h4,{id:"see-1",children:"See"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/classes/Act",children:"Act"})," for available orchestrator methods"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"events",children:"events"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"readonly"})," ",(0,r.jsx)(s.strong,{children:"events"}),": ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/EventRegister",children:(0,r.jsx)(s.code,{children:"EventRegister"})}),"<",(0,r.jsx)(s.code,{children:"E"}),">"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Defined in: ",(0,r.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/b39cb913cd626c8cebba8033cf5dffce85f27baa/libs/act/src/act-builder.ts#L248",children:"libs/act/src/act-builder.ts:248"})]}),"\n",(0,r.jsx)(s.p,{children:"The registered event schemas and their reaction maps."}),"\n",(0,r.jsx)(s.p,{children:"This is an internal registry maintained by the builder. Generally, you don't\nneed to access this directly."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"on",children:"on()"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"on"}),": <",(0,r.jsx)(s.code,{children:"K"}),">(",(0,r.jsx)(s.code,{children:"event"}),") => ",(0,r.jsx)(s.code,{children:"object"})]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Defined in: ",(0,r.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/b39cb913cd626c8cebba8033cf5dffce85f27baa/libs/act/src/act-builder.ts#L106",children:"libs/act/src/act-builder.ts:106"})]}),"\n",(0,r.jsx)(s.p,{children:"Begins defining a reaction to a specific event."}),"\n",(0,r.jsx)(s.p,{children:"Reactions are event handlers that respond to state changes. They can trigger\nadditional actions, update external systems, or perform side effects. Reactions\nare processed asynchronously during drain cycles."}),"\n",(0,r.jsx)(s.h4,{id:"type-parameters-1",children:"Type Parameters"}),"\n",(0,r.jsx)(s.h5,{id:"k",children:"K"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"K"})," ",(0,r.jsx)(s.em,{children:"extends"})," keyof ",(0,r.jsx)(s.code,{children:"E"})]}),"\n",(0,r.jsx)(s.p,{children:"Event name (must be a registered event)"}),"\n",(0,r.jsx)(s.h4,{id:"parameters-1",children:"Parameters"}),"\n",(0,r.jsx)(s.h5,{id:"event",children:"event"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"K"})}),"\n",(0,r.jsx)(s.p,{children:"The event name to react to"}),"\n",(0,r.jsx)(s.h4,{id:"returns-1",children:"Returns"}),"\n",(0,r.jsxs)(s.p,{children:["An object with ",(0,r.jsx)(s.code,{children:".do()"})," method to define the reaction handler"]}),"\n",(0,r.jsx)(s.h5,{id:"do",children:"do()"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"do"}),": (",(0,r.jsx)(s.code,{children:"handler"}),", ",(0,r.jsx)(s.code,{children:"options?"}),") => ",(0,r.jsx)(s.code,{children:"ActBuilder"}),"<",(0,r.jsx)(s.code,{children:"S"}),", ",(0,r.jsx)(s.code,{children:"E"}),", ",(0,r.jsx)(s.code,{children:"A"}),"> & ",(0,r.jsx)(s.code,{children:"object"})]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Defines the reaction handler function for the event."}),"\n",(0,r.jsx)(s.p,{children:"The handler receives the committed event and can:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Perform side effects (send emails, call APIs, etc.)"}),"\n",(0,r.jsxs)(s.li,{children:["Return an action tuple ",(0,r.jsx)(s.code,{children:"[actionName, payload]"})," to trigger another action"]}),"\n",(0,r.jsxs)(s.li,{children:["Return ",(0,r.jsx)(s.code,{children:"void"})," or ",(0,r.jsx)(s.code,{children:"undefined"})," for side-effect-only reactions"]}),"\n"]}),"\n",(0,r.jsx)(s.h6,{id:"parameters-2",children:"Parameters"}),"\n",(0,r.jsx)(s.h6,{id:"handler",children:"handler"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/ReactionHandler",children:(0,r.jsx)(s.code,{children:"ReactionHandler"})}),"<",(0,r.jsx)(s.code,{children:"E"}),", ",(0,r.jsx)(s.code,{children:"K"}),">"]}),"\n",(0,r.jsx)(s.p,{children:"The reaction handler function"}),"\n",(0,r.jsx)(s.h6,{id:"options",children:"options?"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"Partial"}),"<",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/ReactionOptions",children:(0,r.jsx)(s.code,{children:"ReactionOptions"})}),">"]}),"\n",(0,r.jsx)(s.p,{children:"Optional reaction configuration"}),"\n",(0,r.jsx)(s.h6,{id:"returns-2",children:"Returns"}),"\n",(0,r.jsxs)(s.p,{children:["The builder with ",(0,r.jsx)(s.code,{children:".to()"})," and ",(0,r.jsx)(s.code,{children:".void()"})," methods for routing configuration"]}),"\n",(0,r.jsx)(s.h6,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:'.on("UserCreated")\n  .do(async (event) => {\n    await analytics.track("user_created", event.data);\n  })\n  .void()\n'})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:'.on("OrderPlaced")\n  .do(async (event) => {\n    return ["reduceStock", { amount: event.data.items.length }];\n  })\n  .to("inventory-1")\n'})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:'.on("PaymentProcessed")\n  .do(async (event) => {\n    await externalAPI.notify(event.data);\n  }, {\n    blockOnError: false,  // Don\'t block on failure\n    maxRetries: 5         // Retry up to 5 times\n  })\n  .void()\n'})}),"\n",(0,r.jsx)(s.h4,{id:"example-1",children:"Example"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:'const app = act()\n  .with(User)\n  .on("UserCreated")  // React to UserCreated events\n    .do(async (event) => {\n      await sendWelcomeEmail(event.data.email);\n    })\n    .void()\n  .build();\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"with",children:"with()"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"with"}),": <",(0,r.jsx)(s.code,{children:"SX"}),", ",(0,r.jsx)(s.code,{children:"EX"}),", ",(0,r.jsx)(s.code,{children:"AX"}),">(",(0,r.jsx)(s.code,{children:"state"}),") => ",(0,r.jsx)(s.code,{children:"ActBuilder"}),"<",(0,r.jsx)(s.code,{children:"S"})," & ",(0,r.jsx)(s.code,{children:"{ [K in keyof AX]: SX }"}),", ",(0,r.jsx)(s.code,{children:"E"})," & ",(0,r.jsx)(s.code,{children:"EX"}),", ",(0,r.jsx)(s.code,{children:"A"})," & ",(0,r.jsx)(s.code,{children:"AX"}),">"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Defined in: ",(0,r.jsx)(s.a,{href:"https://github.com/Rotorsoft/act-root/blob/b39cb913cd626c8cebba8033cf5dffce85f27baa/libs/act/src/act-builder.ts#L80",children:"libs/act/src/act-builder.ts:80"})]}),"\n",(0,r.jsx)(s.p,{children:"Registers a state definition with the builder."}),"\n",(0,r.jsx)(s.p,{children:"States define aggregates that process actions and emit events. Each state\nregistration adds its actions and events to the orchestrator's registry.\nState names, action names, and event names must be unique across the application."}),"\n",(0,r.jsx)(s.h4,{id:"type-parameters-2",children:"Type Parameters"}),"\n",(0,r.jsx)(s.h5,{id:"sx",children:"SX"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"SX"})," ",(0,r.jsx)(s.em,{children:"extends"})," ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schema",children:(0,r.jsx)(s.code,{children:"Schema"})})]}),"\n",(0,r.jsx)(s.p,{children:"State schema type"}),"\n",(0,r.jsx)(s.h5,{id:"ex",children:"EX"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"EX"})," ",(0,r.jsx)(s.em,{children:"extends"})," ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,r.jsx)(s.code,{children:"Schemas"})})]}),"\n",(0,r.jsx)(s.p,{children:"Event schemas type for this state"}),"\n",(0,r.jsx)(s.h5,{id:"ax",children:"AX"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"AX"})," ",(0,r.jsx)(s.em,{children:"extends"})," ",(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/Schemas",children:(0,r.jsx)(s.code,{children:"Schemas"})})]}),"\n",(0,r.jsx)(s.p,{children:"Action schemas type for this state"}),"\n",(0,r.jsx)(s.h4,{id:"parameters-3",children:"Parameters"}),"\n",(0,r.jsx)(s.h5,{id:"state",children:"state"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.a,{href:"/act-root/docs/api/act/src/type-aliases/State",children:(0,r.jsx)(s.code,{children:"State"})}),"<",(0,r.jsx)(s.code,{children:"SX"}),", ",(0,r.jsx)(s.code,{children:"EX"}),", ",(0,r.jsx)(s.code,{children:"AX"}),">"]}),"\n",(0,r.jsx)(s.p,{children:"The state definition to register"}),"\n",(0,r.jsx)(s.h4,{id:"returns-3",children:"Returns"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"ActBuilder"}),"<",(0,r.jsx)(s.code,{children:"S"})," & ",(0,r.jsx)(s.code,{children:"{ [K in keyof AX]: SX }"}),", ",(0,r.jsx)(s.code,{children:"E"})," & ",(0,r.jsx)(s.code,{children:"EX"}),", ",(0,r.jsx)(s.code,{children:"A"})," & ",(0,r.jsx)(s.code,{children:"AX"}),">"]}),"\n",(0,r.jsx)(s.p,{children:"The builder with updated type information for chaining"}),"\n",(0,r.jsx)(s.h4,{id:"throws",children:"Throws"}),"\n",(0,r.jsx)(s.p,{children:"If a state with duplicate action or event names is registered"}),"\n",(0,r.jsx)(s.h4,{id:"examples-1",children:"Examples"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"const app = act()\n  .with(Counter)\n  .build();\n"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"const app = act()\n  .with(User)\n  .with(Order)\n  .with(Inventory)\n  .build();\n"})})]})}function h(e={}){let{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},5731(e,s,n){n.d(s,{R:()=>i,x:()=>d});var c=n(1299);let r={},t=c.createContext(r);function i(e){let s=c.useContext(t);return c.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),c.createElement(t.Provider,{value:s},e.children)}}}]);