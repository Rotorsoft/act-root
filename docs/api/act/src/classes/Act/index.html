<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-api/act/src/classes/Act" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Act</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://rotorsoft.github.io/act-root/img/logo.svg /><meta data-rh=true name=twitter:image content=https://rotorsoft.github.io/act-root/img/logo.svg /><meta data-rh=true property=og:url content=https://rotorsoft.github.io/act-root/docs/api/act/src/classes/Act /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content=Act /><meta data-rh=true name=description content=@rotorsoft/act-root /><meta data-rh=true property=og:description content=@rotorsoft/act-root /><link data-rh=true rel=icon href=/act-root/img/favicon.ico /><link data-rh=true rel=canonical href=https://rotorsoft.github.io/act-root/docs/api/act/src/classes/Act /><link data-rh=true rel=alternate href=https://rotorsoft.github.io/act-root/docs/api/act/src/classes/Act hreflang=en /><link data-rh=true rel=alternate href=https://rotorsoft.github.io/act-root/docs/api/act/src/classes/Act hreflang=x-default /><link rel=stylesheet href=/act-root/assets/css/styles.f4033280.css /><script src=/act-root/assets/js/runtime~main.39885007.js defer></script><script src=/act-root/assets/js/main.88b63c2f.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/act-root/img/logo.svg /><div role=region aria-label="Skip to main content"><a class=skipToContent_odV9 href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a href=https://rotorsoft.github.io/act-root/ target=_blank rel="noopener noreferrer" class=navbar__brand><div class=navbar__logo><img src=/act-root/img/logo.svg alt="Act Logo" class="themedComponent_dqT2 themedComponent--light_vL61"/><img src=/act-root/img/logo.svg alt="Act Logo" class="themedComponent_dqT2 themedComponent--dark_QZ7f"/></div><b class="navbar__title text--truncate">Act</b></a><a class="navbar__item navbar__link" href=/act-root/docs/intro>Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/rotorsoft/act-root target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_spda><use href=#theme-svg-external-link /></svg></a><div class="toggle_xjI9 colorModeToggle_zfpy"><button class="clean-btn toggleButton_sDQT toggleButtonDisabled_Jch0" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_NgbJ lightToggleIcon_dhWp"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_NgbJ darkToggleIcon_cky5"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_NgbJ systemToggleIcon_jmlA"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_oV1O></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_oCFm"><div class=docsWrapper_fVMm><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_YWVP" type=button></button><div class=docRoot_YjQS><main class="docMainContainer_NQTs docMainContainerEnhanced_nbph"><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_g68i"><div class=docItemContainer_xB3d><article><div class="tocCollapsible_ZSM2 theme-doc-toc-mobile tocMobile_ob4C"><button type=button class="clean-btn tocCollapsibleButton_bUVW">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Act</h1></header><p><a class="" href=/act-root/docs/api/><strong>@rotorsoft/act-root</strong></a></p>
<hr/>
<p><a class="" href=/act-root/docs/api/>@rotorsoft/act-root</a> / <a class="" href=/act-root/docs/api/act/src/>act/src</a> / Act</p>
<h1>Class: Act&lt;S, E, A, M></h1>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L48 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:48</a></p>
<h2 class="anchor anchorTargetStickyNavbar_gAIg" id=see>See<a href=#see class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h2>
<p>Store</p>
<p>Main orchestrator for event-sourced state machines and workflows.</p>
<p>It manages the lifecycle of actions, reactions, and event streams, providing APIs for loading state, executing actions, querying events, and draining reactions.</p>
<h2 class="anchor anchorTargetStickyNavbar_gAIg" id=usage>Usage<a href=#usage class=hash-link aria-label="Direct link to Usage" title="Direct link to Usage" translate=no>​</a></h2>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> app </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">Act</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">registry</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>do</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"increment"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> stream</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"counter1"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> actor </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> by</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> snapshot </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Counter</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"counter1"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>drain</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<ul>
<li class="">Register event listeners with <code>.on("committed", ...)</code> and <code>.on("acked", ...)</code> to react to lifecycle events.</li>
<li class="">Use <code>.query()</code> to analyze event streams for analytics or debugging.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_gAIg" id=type-parameters>Type Parameters<a href=#type-parameters class=hash-link aria-label="Direct link to Type Parameters" title="Direct link to Type Parameters" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=s>S<a href=#s class=hash-link aria-label="Direct link to S" title="Direct link to S" translate=no>​</a></h3>
<p><code>S</code> <em>extends</em> <a class="" href=/act-root/docs/api/act/src/type-aliases/SchemaRegister><code>SchemaRegister</code></a>&lt;<code>A</code>></p>
<p>SchemaRegister for state</p>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=e>E<a href=#e class=hash-link aria-label="Direct link to E" title="Direct link to E" translate=no>​</a></h3>
<p><code>E</code> <em>extends</em> <a class="" href=/act-root/docs/api/act/src/type-aliases/Schemas><code>Schemas</code></a></p>
<p>Schemas for events</p>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=a>A<a href=#a class=hash-link aria-label="Direct link to A" title="Direct link to A" translate=no>​</a></h3>
<p><code>A</code> <em>extends</em> <a class="" href=/act-root/docs/api/act/src/type-aliases/Schemas><code>Schemas</code></a></p>
<p>Schemas for actions</p>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=m>M<a href=#m class=hash-link aria-label="Direct link to M" title="Direct link to M" translate=no>​</a></h3>
<p><code>M</code> <em>extends</em> <code>Record</code>&lt;<code>string</code>, <a class="" href=/act-root/docs/api/act/src/type-aliases/Schema><code>Schema</code></a>> = <code>Record</code>&lt;<code>string</code>, <code>never</code>></p>
<h2 class="anchor anchorTargetStickyNavbar_gAIg" id=constructors>Constructors<a href=#constructors class=hash-link aria-label="Direct link to Constructors" title="Direct link to Constructors" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=constructor>Constructor<a href=#constructor class=hash-link aria-label="Direct link to Constructor" title="Direct link to Constructor" translate=no>​</a></h3>
<blockquote>
<p><strong>new Act</strong>&lt;<code>S</code>, <code>E</code>, <code>A</code>, <code>M</code>>(<code>registry</code>, <code>_states?</code>): <code>Act</code>&lt;<code>S</code>, <code>E</code>, <code>A</code>, <code>M</code>></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L115 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:115</a></p>
<p>Create a new Act orchestrator.</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters>Parameters<a href=#parameters class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=registry>registry<a href=#registry class=hash-link aria-label="Direct link to registry" title="Direct link to registry" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Registry><code>Registry</code></a>&lt;<code>S</code>, <code>E</code>, <code>A</code>></p>
<p>The registry of state, event, and action schemas</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=_states>_states?<a href=#_states class=hash-link aria-label="Direct link to _states?" title="Direct link to _states?" translate=no>​</a></h5>
<p><code>Map</code>&lt;<code>string</code>, <a class="" href=/act-root/docs/api/act/src/type-aliases/State><code>State</code></a>&lt;<code>any</code>, <code>any</code>, <code>any</code>>> = <code>...</code></p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=returns>Returns<a href=#returns class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h4>
<p><code>Act</code>&lt;<code>S</code>, <code>E</code>, <code>A</code>, <code>M</code>></p>
<h2 class="anchor anchorTargetStickyNavbar_gAIg" id=properties>Properties<a href=#properties class=hash-link aria-label="Direct link to Properties" title="Direct link to Properties" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=registry-1>registry<a href=#registry-1 class=hash-link aria-label="Direct link to registry" title="Direct link to registry" translate=no>​</a></h3>
<blockquote>
<p><code>readonly</code> <strong>registry</strong>: <a class="" href=/act-root/docs/api/act/src/type-aliases/Registry><code>Registry</code></a>&lt;<code>S</code>, <code>E</code>, <code>A</code>></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L116 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:116</a></p>
<p>The registry of state, event, and action schemas</p>
<h2 class="anchor anchorTargetStickyNavbar_gAIg" id=methods>Methods<a href=#methods class=hash-link aria-label="Direct link to Methods" title="Direct link to Methods" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=correlate>correlate()<a href=#correlate class=hash-link aria-label="Direct link to correlate()" title="Direct link to correlate()" translate=no>​</a></h3>
<blockquote>
<p><strong>correlate</strong>(<code>query?</code>): <code>Promise</code>&lt;{ <code>last_id</code>: <code>number</code>; <code>leased</code>: <a class="" href=/act-root/docs/api/act/src/type-aliases/Lease><code>Lease</code></a>[]; }></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L679 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:679</a></p>
<p>Discovers and registers new streams dynamically based on reaction resolvers.</p>
<p>Correlation enables "dynamic reactions" where target streams are determined at runtime
based on event content. For example, you might create a stats stream for each user
when they perform certain actions.</p>
<p>This method scans events matching the query and identifies new target streams based
on reaction resolvers. It then registers these streams so they'll be picked up by
the next drain cycle.</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-1>Parameters<a href=#parameters-1 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=query>query?<a href=#query class=hash-link aria-label="Direct link to query?" title="Direct link to query?" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Query><code>Query</code></a> = <code>...</code></p>
<p>Query filter to scan for new correlations</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-1>Returns<a href=#returns-1 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h4>
<p><code>Promise</code>&lt;{ <code>last_id</code>: <code>number</code>; <code>leased</code>: <a class="" href=/act-root/docs/api/act/src/type-aliases/Lease><code>Lease</code></a>[]; }></p>
<p>Object with newly leased streams and last scanned event ID</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=examples>Examples<a href=#examples class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h4>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// Scan for new streams</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> leased</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> last_id </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>correlate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> after</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> limit</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>Found </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">leased</span><span class="token template-string interpolation punctuation" style=color:#393A34>.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> new streams</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// Save last_id for next scan</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>saveCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">last_id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> app </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>act</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>with</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">User</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>with</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">UserStats</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>on</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"UserLoggedIn"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>do</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"incrementLoginCount"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>to</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      target</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>stats-</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">event</span><span class="token template-string interpolation punctuation" style=color:#393A34>.</span><span class="token template-string interpolation">stream</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// Dynamic target per user</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>build</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// Discover stats streams as users log in</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>correlate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=see-1>See<a href=#see-1 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h4>
<ul>
<li class=""><a href=#start_correlations class="">start_correlations</a> for automatic periodic correlation</li>
<li class=""><a href=#stop_correlations class="">stop_correlations</a> to stop automatic correlation</li>
</ul>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=do>do()<a href=#do class=hash-link aria-label="Direct link to do()" title="Direct link to do()" translate=no>​</a></h3>
<blockquote>
<p><strong>do</strong>&lt;<code>K</code>>(<code>action</code>, <code>target</code>, <code>payload</code>, <code>reactingTo?</code>, <code>skipValidation?</code>): <code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot><code>Snapshot</code></a>&lt;<code>S</code>[<code>K</code>], <code>E</code>>[]></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L209 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:209</a></p>
<p>Executes an action on a state instance, committing resulting events.</p>
<p>This is the primary method for modifying state. It:</p>
<ol>
<li class="">Validates the action payload against the schema</li>
<li class="">Loads the current state snapshot</li>
<li class="">Checks invariants (business rules)</li>
<li class="">Executes the action handler to generate events</li>
<li class="">Applies events to create new state</li>
<li class="">Commits events to the store with optimistic concurrency control</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=type-parameters-1>Type Parameters<a href=#type-parameters-1 class=hash-link aria-label="Direct link to Type Parameters" title="Direct link to Type Parameters" translate=no>​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=k>K<a href=#k class=hash-link aria-label="Direct link to K" title="Direct link to K" translate=no>​</a></h5>
<p><code>K</code> <em>extends</em> <code>string</code> | <code>number</code> | <code>symbol</code></p>
<p>Action name from registered actions</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-2>Parameters<a href=#parameters-2 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=action>action<a href=#action class=hash-link aria-label="Direct link to action" title="Direct link to action" translate=no>​</a></h5>
<p><code>K</code></p>
<p>The name of the action to execute</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=target>target<a href=#target class=hash-link aria-label="Direct link to target" title="Direct link to target" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Target><code>Target</code></a></p>
<p>Target specification with stream ID and actor context</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=payload>payload<a href=#payload class=hash-link aria-label="Direct link to payload" title="Direct link to payload" translate=no>​</a></h5>
<p><code>Readonly</code>&lt;<code>A</code>[<code>K</code>]></p>
<p>Action payload matching the action's schema</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=reactingto>reactingTo?<a href=#reactingto class=hash-link aria-label="Direct link to reactingTo?" title="Direct link to reactingTo?" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Committed><code>Committed</code></a>&lt;<code>E</code>, <code>string</code> & keyof <code>E</code>></p>
<p>Optional event that triggered this action (for correlation)</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=skipvalidation>skipValidation?<a href=#skipvalidation class=hash-link aria-label="Direct link to skipValidation?" title="Direct link to skipValidation?" translate=no>​</a></h5>
<p><code>boolean</code> = <code>false</code></p>
<p>Skip schema validation (use carefully, for performance)</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-2>Returns<a href=#returns-2 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h4>
<p><code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot><code>Snapshot</code></a>&lt;<code>S</code>[<code>K</code>], <code>E</code>>[]></p>
<p>Array of snapshots for all affected states (usually one)</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=throws>Throws<a href=#throws class=hash-link aria-label="Direct link to Throws" title="Direct link to Throws" translate=no>​</a></h4>
<p>If payload doesn't match action schema</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=throws-1>Throws<a href=#throws-1 class=hash-link aria-label="Direct link to Throws" title="Direct link to Throws" translate=no>​</a></h4>
<p>If business rules are violated</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=throws-2>Throws<a href=#throws-2 class=hash-link aria-label="Direct link to Throws" title="Direct link to Throws" translate=no>​</a></h4>
<p>If another process modified the stream</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=examples-1>Examples<a href=#examples-1 class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h4>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> snapshots </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>do</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string" style=color:#e3116c>"increment"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    stream</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"counter-1"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    actor</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> id</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"user1"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> name</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Alice"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> by</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>5</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">snapshots</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">state</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">count</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// Current count after increment</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>try</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>do</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"withdraw"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> stream</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"account-123"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> actor</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> id</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"user1"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> name</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Alice"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> amount</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1000</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>catch</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">error</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">error </span><span class="token keyword" style=color:#00009f>instanceof</span><span class="token plain"> </span><span class="token class-name">InvariantError</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>error</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Business rule violated:"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> error</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">description</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">error </span><span class="token keyword" style=color:#00009f>instanceof</span><span class="token plain"> </span><span class="token class-name">ConcurrencyError</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>error</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Concurrent modification detected, retry..."</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">error </span><span class="token keyword" style=color:#00009f>instanceof</span><span class="token plain"> </span><span class="token class-name">ValidationError</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>error</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Invalid payload:"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> error</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">details</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> app </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>act</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>with</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Order</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>with</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Inventory</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>on</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"OrderPlaced"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>do</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> context</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// This action is triggered by an event</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> result </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> context</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>do</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"reduceStock"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">          stream</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"inventory-1"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">          actor</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> event</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">meta</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">causation</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">action</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">actor</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> amount</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> event</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">data</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">items</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">length </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        event </span><span class="token comment" style=color:#999988;font-style:italic>// Pass event for correlation tracking</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> result</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>to</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"inventory-1"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>build</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=see-2>See<a href=#see-2 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h4>
<ul>
<li class=""><a class="" href=/act-root/docs/api/act/src/type-aliases/Target>Target</a> for target structure</li>
<li class=""><a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot>Snapshot</a> for return value structure</li>
<li class=""><a class="" href=/act-root/docs/api/act/src/classes/ValidationError>ValidationError</a>, <a class="" href=/act-root/docs/api/act/src/classes/InvariantError>InvariantError</a>, <a class="" href=/act-root/docs/api/act/src/classes/ConcurrencyError>ConcurrencyError</a></li>
</ul>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=drain>drain()<a href=#drain class=hash-link aria-label="Direct link to drain()" title="Direct link to drain()" translate=no>​</a></h3>
<blockquote>
<p><strong>drain</strong>(<code>options?</code>): <code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Drain><code>Drain</code></a>&lt;<code>E</code>>></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L515 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:515</a></p>
<p>Processes pending reactions by draining uncommitted events from the event store.</p>
<p>The drain process:</p>
<ol>
<li class="">Polls the store for streams with uncommitted events</li>
<li class="">Leases streams to prevent concurrent processing</li>
<li class="">Fetches events for each leased stream</li>
<li class="">Executes matching reaction handlers</li>
<li class="">Acknowledges successful reactions or blocks failing ones</li>
</ol>
<p>Drain uses a dual-frontier strategy to balance processing of new streams (lagging)
vs active streams (leading). The ratio adapts based on event pressure.</p>
<p>Call this method periodically in a background loop, or after committing events.</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-3>Parameters<a href=#parameters-3 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=options>options?<a href=#options class=hash-link aria-label="Direct link to options?" title="Direct link to options?" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/DrainOptions><code>DrainOptions</code></a> = <code>{}</code></p>
<p>Drain configuration options</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-3>Returns<a href=#returns-3 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h4>
<p><code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Drain><code>Drain</code></a>&lt;<code>E</code>>></p>
<p>Drain statistics with fetched, leased, acked, and blocked counts</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=examples-2>Examples<a href=#examples-2 class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h4>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// Process reactions after each action</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>do</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"createUser"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> payload</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>drain</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>setInterval</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>try</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> result </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>drain</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      streamLimit</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      eventLimit</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>50</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">result</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">acked</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">length</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>Processed </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">result</span><span class="token template-string interpolation punctuation" style=color:#393A34>.</span><span class="token template-string interpolation">acked</span><span class="token template-string interpolation punctuation" style=color:#393A34>.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> streams</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>catch</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">error</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>error</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Drain error:"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> error</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>5000</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// Every 5 seconds</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>on</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"acked"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">leases</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>Acknowledged </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">leases</span><span class="token template-string interpolation punctuation" style=color:#393A34>.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> streams</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>on</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"blocked"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">blocked</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>error</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>Blocked </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">blocked</span><span class="token template-string interpolation punctuation" style=color:#393A34>.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> streams due to errors</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  blocked</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>forEach</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> stream</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> error </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>error</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>Stream </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">stream</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c>: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">error</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>drain</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=see-3>See<a href=#see-3 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h4>
<ul>
<li class=""><a href=#correlate class="">correlate</a> for dynamic stream discovery</li>
<li class=""><a href=#start_correlations class="">start_correlations</a> for automatic correlation</li>
</ul>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=emit>emit()<a href=#emit class=hash-link aria-label="Direct link to emit()" title="Direct link to emit()" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature>Call Signature<a href=#call-signature class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>emit</strong>(<code>event</code>, <code>args</code>): <code>boolean</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L66 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:66</a></p>
<p>Emit a lifecycle event (internal use, but can be used for custom listeners).</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-4>Parameters<a href=#parameters-4 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event>event<a href=#event class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"committed"</code></p>
<p>The event name ("committed", "acked",  or "blocked")</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=args>args<a href=#args class=hash-link aria-label="Direct link to args" title="Direct link to args" translate=no>​</a></h6>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot><code>Snapshot</code></a>&lt;<code>S</code>, <code>E</code>>[]</p>
<p>The event payload</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-4>Returns<a href=#returns-4 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>boolean</code></p>
<p>true if the event had listeners, false otherwise</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-1>Call Signature<a href=#call-signature-1 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>emit</strong>(<code>event</code>, <code>args</code>): <code>boolean</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L67 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:67</a></p>
<p>Emit a lifecycle event (internal use, but can be used for custom listeners).</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-5>Parameters<a href=#parameters-5 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event-1>event<a href=#event-1 class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"acked"</code></p>
<p>The event name ("committed", "acked",  or "blocked")</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=args-1>args<a href=#args-1 class=hash-link aria-label="Direct link to args" title="Direct link to args" translate=no>​</a></h6>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Lease><code>Lease</code></a>[]</p>
<p>The event payload</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-5>Returns<a href=#returns-5 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>boolean</code></p>
<p>true if the event had listeners, false otherwise</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-2>Call Signature<a href=#call-signature-2 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>emit</strong>(<code>event</code>, <code>args</code>): <code>boolean</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L68 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:68</a></p>
<p>Emit a lifecycle event (internal use, but can be used for custom listeners).</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-6>Parameters<a href=#parameters-6 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event-2>event<a href=#event-2 class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"blocked"</code></p>
<p>The event name ("committed", "acked",  or "blocked")</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=args-2>args<a href=#args-2 class=hash-link aria-label="Direct link to args" title="Direct link to args" translate=no>​</a></h6>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Lease><code>Lease</code></a> & <code>object</code>[]</p>
<p>The event payload</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-6>Returns<a href=#returns-6 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>boolean</code></p>
<p>true if the event had listeners, false otherwise</p>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=load>load()<a href=#load class=hash-link aria-label="Direct link to load()" title="Direct link to load()" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-3>Call Signature<a href=#call-signature-3 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>load</strong>&lt;<code>SX</code>, <code>EX</code>, <code>AX</code>>(<code>state</code>, <code>stream</code>, <code>callback?</code>): <code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot><code>Snapshot</code></a>&lt;<code>SX</code>, <code>EX</code>>></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L269 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:269</a></p>
<p>Loads the current state snapshot for a specific stream.</p>
<p>Reconstructs the current state by replaying events from the event store.
Uses snapshots when available to optimize loading performance.</p>
<p>Accepts either a State definition object or a state name string. When
using a string, the merged state (from partial states registered via
<code>.with()</code>) is resolved by name.</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=type-parameters-2>Type Parameters<a href=#type-parameters-2 class=hash-link aria-label="Direct link to Type Parameters" title="Direct link to Type Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=sx>SX<a href=#sx class=hash-link aria-label="Direct link to SX" title="Direct link to SX" translate=no>​</a></h6>
<p><code>SX</code> <em>extends</em> <a class="" href=/act-root/docs/api/act/src/type-aliases/Schema><code>Schema</code></a></p>
<p>State schema type</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=ex>EX<a href=#ex class=hash-link aria-label="Direct link to EX" title="Direct link to EX" translate=no>​</a></h6>
<p><code>EX</code> <em>extends</em> <a class="" href=/act-root/docs/api/act/src/type-aliases/Schemas><code>Schemas</code></a></p>
<p>Event schemas type</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=ax>AX<a href=#ax class=hash-link aria-label="Direct link to AX" title="Direct link to AX" translate=no>​</a></h6>
<p><code>AX</code> <em>extends</em> <a class="" href=/act-root/docs/api/act/src/type-aliases/Schemas><code>Schemas</code></a></p>
<p>Action schemas type</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-7>Parameters<a href=#parameters-7 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=state>state<a href=#state class=hash-link aria-label="Direct link to state" title="Direct link to state" translate=no>​</a></h6>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/State><code>State</code></a>&lt;<code>SX</code>, <code>EX</code>, <code>AX</code>></p>
<p>The state definition or state name to load</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=stream>stream<a href=#stream class=hash-link aria-label="Direct link to stream" title="Direct link to stream" translate=no>​</a></h6>
<p><code>string</code></p>
<p>The stream ID (state instance identifier)</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=callback>callback?<a href=#callback class=hash-link aria-label="Direct link to callback?" title="Direct link to callback?" translate=no>​</a></h6>
<p>(<code>snapshot</code>) => <code>void</code></p>
<p>Optional callback invoked with the loaded snapshot</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-7>Returns<a href=#returns-7 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot><code>Snapshot</code></a>&lt;<code>SX</code>, <code>EX</code>>></p>
<p>The current state snapshot for the stream</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=examples-3>Examples<a href=#examples-3 class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h5>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> snapshot </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Counter</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"counter-1"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">snapshot</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">state</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">count</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Current count</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">snapshot</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">patches</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>// Events since last snapshot</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> snapshot </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Ticket"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ticket-123"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">snapshot</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">state</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">title</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Merged state from all partials</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">user</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> account</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> </span><span class="token builtin">Promise</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>all</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">User</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"user-123"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">BankAccount</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"account-456"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=see-4>See<a href=#see-4 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot>Snapshot</a> for snapshot structure</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-4>Call Signature<a href=#call-signature-4 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>load</strong>&lt;<code>K</code>>(<code>name</code>, <code>stream</code>, <code>callback?</code>): <code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot><code>Snapshot</code></a>&lt;<code>M</code>[<code>K</code>], <code>E</code>>></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L274 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:274</a></p>
<p>Loads the current state snapshot for a specific stream.</p>
<p>Reconstructs the current state by replaying events from the event store.
Uses snapshots when available to optimize loading performance.</p>
<p>Accepts either a State definition object or a state name string. When
using a string, the merged state (from partial states registered via
<code>.with()</code>) is resolved by name.</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=type-parameters-3>Type Parameters<a href=#type-parameters-3 class=hash-link aria-label="Direct link to Type Parameters" title="Direct link to Type Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=k-1>K<a href=#k-1 class=hash-link aria-label="Direct link to K" title="Direct link to K" translate=no>​</a></h6>
<p><code>K</code> <em>extends</em> <code>string</code></p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-8>Parameters<a href=#parameters-8 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=name>name<a href=#name class=hash-link aria-label="Direct link to name" title="Direct link to name" translate=no>​</a></h6>
<p><code>K</code></p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=stream-1>stream<a href=#stream-1 class=hash-link aria-label="Direct link to stream" title="Direct link to stream" translate=no>​</a></h6>
<p><code>string</code></p>
<p>The stream ID (state instance identifier)</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=callback-1>callback?<a href=#callback-1 class=hash-link aria-label="Direct link to callback?" title="Direct link to callback?" translate=no>​</a></h6>
<p>(<code>snapshot</code>) => <code>void</code></p>
<p>Optional callback invoked with the loaded snapshot</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-8>Returns<a href=#returns-8 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot><code>Snapshot</code></a>&lt;<code>M</code>[<code>K</code>], <code>E</code>>></p>
<p>The current state snapshot for the stream</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=examples-4>Examples<a href=#examples-4 class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h5>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> snapshot </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Counter</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"counter-1"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">snapshot</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">state</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">count</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Current count</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">snapshot</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">patches</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>// Events since last snapshot</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> snapshot </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Ticket"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ticket-123"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">snapshot</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">state</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">title</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Merged state from all partials</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">user</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> account</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> </span><span class="token builtin">Promise</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>all</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">User</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"user-123"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">BankAccount</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"account-456"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=see-5>See<a href=#see-5 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Snapshot>Snapshot</a> for snapshot structure</p>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=off>off()<a href=#off class=hash-link aria-label="Direct link to off()" title="Direct link to off()" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-5>Call Signature<a href=#call-signature-5 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>off</strong>(<code>event</code>, <code>listener</code>): <code>this</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L98 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:98</a></p>
<p>Remove a listener for a lifecycle event.</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-9>Parameters<a href=#parameters-9 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event-3>event<a href=#event-3 class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"committed"</code></p>
<p>The event name</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=listener>listener<a href=#listener class=hash-link aria-label="Direct link to listener" title="Direct link to listener" translate=no>​</a></h6>
<p>(<code>args</code>) => <code>void</code></p>
<p>The callback function</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-9>Returns<a href=#returns-9 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>this</code></p>
<p>this (for chaining)</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-6>Call Signature<a href=#call-signature-6 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>off</strong>(<code>event</code>, <code>listener</code>): <code>this</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L99 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:99</a></p>
<p>Remove a listener for a lifecycle event.</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-10>Parameters<a href=#parameters-10 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event-4>event<a href=#event-4 class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"acked"</code></p>
<p>The event name</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=listener-1>listener<a href=#listener-1 class=hash-link aria-label="Direct link to listener" title="Direct link to listener" translate=no>​</a></h6>
<p>(<code>args</code>) => <code>void</code></p>
<p>The callback function</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-10>Returns<a href=#returns-10 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>this</code></p>
<p>this (for chaining)</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-7>Call Signature<a href=#call-signature-7 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>off</strong>(<code>event</code>, <code>listener</code>): <code>this</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L100 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:100</a></p>
<p>Remove a listener for a lifecycle event.</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-11>Parameters<a href=#parameters-11 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event-5>event<a href=#event-5 class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"blocked"</code></p>
<p>The event name</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=listener-2>listener<a href=#listener-2 class=hash-link aria-label="Direct link to listener" title="Direct link to listener" translate=no>​</a></h6>
<p>(<code>args</code>) => <code>void</code></p>
<p>The callback function</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-11>Returns<a href=#returns-11 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>this</code></p>
<p>this (for chaining)</p>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=on>on()<a href=#on class=hash-link aria-label="Direct link to on()" title="Direct link to on()" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-8>Call Signature<a href=#call-signature-8 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>on</strong>(<code>event</code>, <code>listener</code>): <code>this</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L80 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:80</a></p>
<p>Register a listener for a lifecycle event ("committed", "acked", or "blocked").</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-12>Parameters<a href=#parameters-12 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event-6>event<a href=#event-6 class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"committed"</code></p>
<p>The event name</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=listener-3>listener<a href=#listener-3 class=hash-link aria-label="Direct link to listener" title="Direct link to listener" translate=no>​</a></h6>
<p>(<code>args</code>) => <code>void</code></p>
<p>The callback function</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-12>Returns<a href=#returns-12 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>this</code></p>
<p>this (for chaining)</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-9>Call Signature<a href=#call-signature-9 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>on</strong>(<code>event</code>, <code>listener</code>): <code>this</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L81 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:81</a></p>
<p>Register a listener for a lifecycle event ("committed", "acked", or "blocked").</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-13>Parameters<a href=#parameters-13 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event-7>event<a href=#event-7 class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"acked"</code></p>
<p>The event name</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=listener-4>listener<a href=#listener-4 class=hash-link aria-label="Direct link to listener" title="Direct link to listener" translate=no>​</a></h6>
<p>(<code>args</code>) => <code>void</code></p>
<p>The callback function</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-13>Returns<a href=#returns-13 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>this</code></p>
<p>this (for chaining)</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=call-signature-10>Call Signature<a href=#call-signature-10 class=hash-link aria-label="Direct link to Call Signature" title="Direct link to Call Signature" translate=no>​</a></h4>
<blockquote>
<p><strong>on</strong>(<code>event</code>, <code>listener</code>): <code>this</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L82 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:82</a></p>
<p>Register a listener for a lifecycle event ("committed", "acked", or "blocked").</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-14>Parameters<a href=#parameters-14 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h5>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=event-8>event<a href=#event-8 class=hash-link aria-label="Direct link to event" title="Direct link to event" translate=no>​</a></h6>
<p><code>"blocked"</code></p>
<p>The event name</p>
<h6 class="anchor anchorTargetStickyNavbar_gAIg" id=listener-5>listener<a href=#listener-5 class=hash-link aria-label="Direct link to listener" title="Direct link to listener" translate=no>​</a></h6>
<p>(<code>args</code>) => <code>void</code></p>
<p>The callback function</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-14>Returns<a href=#returns-14 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h5>
<p><code>this</code></p>
<p>this (for chaining)</p>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=query-1>query()<a href=#query-1 class=hash-link aria-label="Direct link to query()" title="Direct link to query()" translate=no>​</a></h3>
<blockquote>
<p><strong>query</strong>(<code>query</code>, <code>callback?</code>): <code>Promise</code>&lt;{ <code>count</code>: <code>number</code>; <code>first?</code>: <a class="" href=/act-root/docs/api/act/src/type-aliases/Committed><code>Committed</code></a>&lt;<code>E</code>, keyof <code>E</code>>; <code>last?</code>: <a class="" href=/act-root/docs/api/act/src/type-aliases/Committed><code>Committed</code></a>&lt;<code>E</code>, keyof <code>E</code>>; }></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L346 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:346</a></p>
<p>Queries the event store for events matching a filter.</p>
<p>Use this for analyzing event streams, generating reports, or debugging.
The callback is invoked for each matching event, and the method returns
summary information (first event, last event, total count).</p>
<p>For small result sets, consider using <a href=#query_array class="">query_array</a> instead.</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-15>Parameters<a href=#parameters-15 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=query-2>query<a href=#query-2 class=hash-link aria-label="Direct link to query" title="Direct link to query" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Query><code>Query</code></a></p>
<p>The query filter</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=callback-2>callback?<a href=#callback-2 class=hash-link aria-label="Direct link to callback?" title="Direct link to callback?" translate=no>​</a></h5>
<p>(<code>event</code>) => <code>void</code></p>
<p>Optional callback invoked for each matching event</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-15>Returns<a href=#returns-15 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h4>
<p><code>Promise</code>&lt;{ <code>count</code>: <code>number</code>; <code>first?</code>: <a class="" href=/act-root/docs/api/act/src/type-aliases/Committed><code>Committed</code></a>&lt;<code>E</code>, keyof <code>E</code>>; <code>last?</code>: <a class="" href=/act-root/docs/api/act/src/type-aliases/Committed><code>Committed</code></a>&lt;<code>E</code>, keyof <code>E</code>>; }></p>
<p>Object with first event, last event, and total count</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=examples-5>Examples<a href=#examples-5 class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h4>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> first</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> last</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> count </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>query</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> stream</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"counter-1"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">name</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> event</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">data</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>Found </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">count</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> events from </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">first</span><span class="token template-string interpolation operator" style=color:#393A34>?.</span><span class="token template-string interpolation">id</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> to </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">last</span><span class="token template-string interpolation operator" style=color:#393A34>?.</span><span class="token template-string interpolation">id</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> count </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>query</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> name</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"UserCreated"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> limit</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"User created:"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> event</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">data</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">email</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> yesterday </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Date</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>now</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>24</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>60</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>60</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1000</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> count </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>query</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  created_after</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> yesterday</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  stream</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"user-123"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>User had </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">count</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> events in last 24 hours</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=see-6>See<a href=#see-6 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h4>
<p><a href=#query_array class="">query_array</a> for loading events into memory</p>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=query_array>query_array()<a href=#query_array class=hash-link aria-label="Direct link to query_array()" title="Direct link to query_array()" translate=no>​</a></h3>
<blockquote>
<p><strong>query_array</strong>(<code>query</code>): <code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Committed><code>Committed</code></a>&lt;<code>E</code>, keyof <code>E</code>>[]></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L390 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:390</a></p>
<p>Queries the event store and returns all matching events in memory.</p>
<p><strong>Use with caution</strong> - this loads all results into memory. For large result sets,
use <a href=#query_array class="">query</a> with a callback instead to process events incrementally.</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-16>Parameters<a href=#parameters-16 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=query-3>query<a href=#query-3 class=hash-link aria-label="Direct link to query" title="Direct link to query" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Query><code>Query</code></a></p>
<p>The query filter (same as <a href=#query_array class="">query</a>)</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-16>Returns<a href=#returns-16 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h4>
<p><code>Promise</code>&lt;<a class="" href=/act-root/docs/api/act/src/type-aliases/Committed><code>Committed</code></a>&lt;<code>E</code>, keyof <code>E</code>>[]></p>
<p>Array of all matching events</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=examples-6>Examples<a href=#examples-6 class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h4>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> events </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>query_array</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> stream</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"counter-1"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>Loaded </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">events</span><span class="token template-string interpolation punctuation" style=color:#393A34>.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> events</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">events</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>forEach</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">name</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> event</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">data</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> recent </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>query_array</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  stream</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"user-123"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  limit</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>10</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=see-7>See<a href=#see-7 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h4>
<p><a href=#query_array class="">query</a> for large result sets</p>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=start_correlations>start_correlations()<a href=#start_correlations class=hash-link aria-label="Direct link to start_correlations()" title="Direct link to start_correlations()" translate=no>​</a></h3>
<blockquote>
<p><strong>start_correlations</strong>(<code>query?</code>, <code>frequency?</code>, <code>callback?</code>): <code>boolean</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L776 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:776</a></p>
<p>Starts automatic periodic correlation worker for discovering new streams.</p>
<p>The correlation worker runs in the background, scanning for new events and identifying
new target streams based on reaction resolvers. It maintains a sliding window that
advances with each scan, ensuring all events are eventually correlated.</p>
<p>This is useful for dynamic stream creation patterns where you don't know all streams
upfront - they're discovered as events arrive.</p>
<p><strong>Note:</strong> Only one correlation worker can run at a time per Act instance.</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=parameters-17>Parameters<a href=#parameters-17 class=hash-link aria-label="Direct link to Parameters" title="Direct link to Parameters" translate=no>​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=query-4>query?<a href=#query-4 class=hash-link aria-label="Direct link to query?" title="Direct link to query?" translate=no>​</a></h5>
<p><a class="" href=/act-root/docs/api/act/src/type-aliases/Query><code>Query</code></a> = <code>{}</code></p>
<p>Query filter for correlation scans</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=frequency>frequency?<a href=#frequency class=hash-link aria-label="Direct link to frequency?" title="Direct link to frequency?" translate=no>​</a></h5>
<p><code>number</code> = <code>10_000</code></p>
<p>Correlation frequency in milliseconds (default: 10000)</p>
<h5 class="anchor anchorTargetStickyNavbar_gAIg" id=callback-3>callback?<a href=#callback-3 class=hash-link aria-label="Direct link to callback?" title="Direct link to callback?" translate=no>​</a></h5>
<p>(<code>leased</code>) => <code>void</code></p>
<p>Optional callback invoked with newly discovered streams</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-17>Returns<a href=#returns-17 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h4>
<p><code>boolean</code></p>
<p><code>true</code> if worker started, <code>false</code> if already running</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=examples-7>Examples<a href=#examples-7 class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h4>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// Start correlation worker scanning every 5 seconds</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>start_correlations</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> after</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> limit</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token number" style=color:#36acaa>5000</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">leased</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>Discovered </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">leased</span><span class="token template-string interpolation punctuation" style=color:#393A34>.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c> new streams</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// Later, stop it</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>stop_correlations</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// Load last checkpoint</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> lastId </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>loadCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>start_correlations</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> after</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> lastId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> limit</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token number" style=color:#36acaa>10000</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">leased</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Save checkpoint for next restart</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">leased</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">length</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> maxId </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Math</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>max</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>...</span><span class="token plain">leased</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>map</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">l </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> l</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">at</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>saveCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">maxId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=see-8>See<a href=#see-8 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h4>
<ul>
<li class=""><a href=#correlate class="">correlate</a> for manual one-time correlation</li>
<li class=""><a href=#stop_correlations class="">stop_correlations</a> to stop the worker</li>
</ul>
<hr/>
<h3 class="anchor anchorTargetStickyNavbar_gAIg" id=stop_correlations>stop_correlations()<a href=#stop_correlations class=hash-link aria-label="Direct link to stop_correlations()" title="Direct link to stop_correlations()" translate=no>​</a></h3>
<blockquote>
<p><strong>stop_correlations</strong>(): <code>void</code></p>
</blockquote>
<p>Defined in: <a href=https://github.com/Rotorsoft/act-root/blob/258a8278b682de63b1f9b50cd065c03d8caa36cc/libs/act/src/act.ts#L815 target=_blank rel="noopener noreferrer" class="">libs/act/src/act.ts:815</a></p>
<p>Stops the automatic correlation worker.</p>
<p>Call this to stop the background correlation worker started by <a href=#start_correlations class="">start_correlations</a>.
This is automatically called when the Act instance is disposed.</p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=returns-18>Returns<a href=#returns-18 class=hash-link aria-label="Direct link to Returns" title="Direct link to Returns" translate=no>​</a></h4>
<p><code>void</code></p>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=example>Example<a href=#example class=hash-link aria-label="Direct link to Example" title="Direct link to Example" translate=no>​</a></h4>
<div class="language-typescript codeBlockContainer_WcMm theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_W9re><pre tabindex=0 class="prism-code language-typescript codeBlock_vZ8S thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_AFJW><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// Start correlation</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>start_correlations</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// Later, stop it</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>stop_correlations</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_gAIg" id=see-9>See<a href=#see-9 class=hash-link aria-label="Direct link to See" title="Direct link to See" translate=no>​</a></h4>
<p><a href=#start_correlations class="">start_correlations</a></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_rOvL"><a href=https://github.com/rotorsoft/act-root/edit/master/docs/docs/api/act/src/classes/Act.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_ITks aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_GYIT"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_aJOK thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#see class="table-of-contents__link toc-highlight">See</a><li><a href=#usage class="table-of-contents__link toc-highlight">Usage</a><li><a href=#type-parameters class="table-of-contents__link toc-highlight">Type Parameters</a><ul><li><a href=#s class="table-of-contents__link toc-highlight">S</a><li><a href=#e class="table-of-contents__link toc-highlight">E</a><li><a href=#a class="table-of-contents__link toc-highlight">A</a><li><a href=#m class="table-of-contents__link toc-highlight">M</a></ul><li><a href=#constructors class="table-of-contents__link toc-highlight">Constructors</a><ul><li><a href=#constructor class="table-of-contents__link toc-highlight">Constructor</a></ul><li><a href=#properties class="table-of-contents__link toc-highlight">Properties</a><ul><li><a href=#registry-1 class="table-of-contents__link toc-highlight">registry</a></ul><li><a href=#methods class="table-of-contents__link toc-highlight">Methods</a><ul><li><a href=#correlate class="table-of-contents__link toc-highlight">correlate()</a><li><a href=#do class="table-of-contents__link toc-highlight">do()</a><li><a href=#drain class="table-of-contents__link toc-highlight">drain()</a><li><a href=#emit class="table-of-contents__link toc-highlight">emit()</a><li><a href=#load class="table-of-contents__link toc-highlight">load()</a><li><a href=#off class="table-of-contents__link toc-highlight">off()</a><li><a href=#on class="table-of-contents__link toc-highlight">on()</a><li><a href=#query-1 class="table-of-contents__link toc-highlight">query()</a><li><a href=#query_array class="table-of-contents__link toc-highlight">query_array()</a><li><a href=#start_correlations class="table-of-contents__link toc-highlight">start_correlations()</a><li><a href=#stop_correlations class="table-of-contents__link toc-highlight">stop_correlations()</a></ul></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Docs</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/act-root/docs/intro>Introduction</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/rotorsoft/act-root target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_spda><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2026 Rotorsoft. Built with Docusaurus.</div></div></div></footer></div></body>